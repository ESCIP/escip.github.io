
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Time evolution of a Gaussian wavepacket &#8212; ESCIP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Linear Variational Method" href="linear_variational_method.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESCIP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../team.html">
   Team
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../guidelines/intro.html">
   Guidelines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../guidelines/guidelines.html">
     Format of notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guidelines/template.html">
     Template notebook
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../workshops/intro.html">
   Workshops
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../workshops/workshop2023.html">
     January 2023 In-Person Workshop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../workshops/workshop2022.html">
     Summer 2022 In-Person Workshop
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fourier_transform.html">
   Fourier Transforms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_variational_method.html">
   Linear Variational Method
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Time evolution of a Gaussian wavepacket
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ESCIP/escip.github.io/jbook?urlpath=lab/tree/notebooks/gaussian_wavepacket.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ESCIP/escip.github.io/blob/jbook/notebooks/gaussian_wavepacket.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ESCIP/escip.github.io"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ESCIP/escip.github.io/issues/new?title=Issue%20on%20page%20%2Fnotebooks/gaussian_wavepacket.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/gaussian_wavepacket.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Time evolution of a Gaussian wavepacket
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-outcomes">
     Learning Outcomes
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">
     Step 0:  Import libraries and initialize a plot object for the animation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-define-helper-functions-that-will-compute-the-pib-basis-functions-and-energy-eigenvalues">
       Step 1: Define helper functions that will compute the PIB basis functions and energy eigenvalues
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-define-a-helper-function-that-will-compute-values-of-the-gaussian-wavepacket">
       Step 2: Define a helper function that will compute values of the Gaussian wavepacket
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-set-up-plot-and-function-parameters-and-form-the-gaussian-wavepacket-at-time-t-t0">
       Step 3: Set up plot and function parameters and form the Gaussian Wavepacket at time t=t0
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-write-helper-functions-so-that-the-wavepacket-can-be-expanded-in-the-pib-basis">
       Step 2: Write helper functions so that the wavepacket can be expanded in the PIB basis
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#step-3-determine-the-expansion-coefficients-for-the-gaussian-wavepacket-in-the-pib-basis">
         Step 3:  Determine the expansion coefficients for the Gaussian Wavepacket in the PIB basis
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-put-it-all-together-and-animate">
       Step 4: Put it all together and animate!
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-link">
   Reference Link
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Time evolution of a Gaussian wavepacket</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Time evolution of a Gaussian wavepacket
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-outcomes">
     Learning Outcomes
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">
     Step 0:  Import libraries and initialize a plot object for the animation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-define-helper-functions-that-will-compute-the-pib-basis-functions-and-energy-eigenvalues">
       Step 1: Define helper functions that will compute the PIB basis functions and energy eigenvalues
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-define-a-helper-function-that-will-compute-values-of-the-gaussian-wavepacket">
       Step 2: Define a helper function that will compute values of the Gaussian wavepacket
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-set-up-plot-and-function-parameters-and-form-the-gaussian-wavepacket-at-time-t-t0">
       Step 3: Set up plot and function parameters and form the Gaussian Wavepacket at time t=t0
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-write-helper-functions-so-that-the-wavepacket-can-be-expanded-in-the-pib-basis">
       Step 2: Write helper functions so that the wavepacket can be expanded in the PIB basis
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#step-3-determine-the-expansion-coefficients-for-the-gaussian-wavepacket-in-the-pib-basis">
         Step 3:  Determine the expansion coefficients for the Gaussian Wavepacket in the PIB basis
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-put-it-all-together-and-animate">
       Step 4: Put it all together and animate!
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-link">
   Reference Link
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/FoleyLab/FoleyLab.github.io/blob/master/notebooks/Wavepacket_animations.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="time-evolution-of-a-gaussian-wavepacket">
<h1>Time evolution of a Gaussian wavepacket<a class="headerlink" href="#time-evolution-of-a-gaussian-wavepacket" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://foleylab.github.io/">Prof. Jay Foley, University of North Carolina Charlotte</a></p>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>To demonstrate the expansion of a Gaussian wavepacket as a superposition of particle-in-a-box energy eigenstates</p></li>
<li><p>To demonstrate the time-dependence of a Gaussian wavepacket traveling between two infinitely tall potential walls</p></li>
<li><p>To calculate the momentum uncertainty of the Gaussian wavepacket as a function of time</p></li>
</ul>
</section>
<section id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">#</a></h2>
<p>By the end of this workbook, students should be able to</p>
<ul class="simple">
<li><p>Expand an arbitrary wavefunction in the energy eigenstate basis, and specifically apply this to the expansion of a Gaussian wavepacket in the basis of the particle-in-a-box energy eigenstates</p></li>
<li><p>Utilize the <code class="docutils literal notranslate"><span class="pre">trapz</span></code> function of <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to perform numeric integration</p></li>
<li><p>Use the known time dependence of energy eigenstates of the particle-in-a-box to simulate the time evolution of the Gaussian wavepacket travelling between two infinitely tall ptential walls</p></li>
<li><p>Use the capabilities of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to animate the motion of the Gaussian wavepacket</p></li>
<li><p>Compute time-dependent expectation values of the Gaussian wavepacket, and specifically track the momentum uncertainty of this state as a function of time.</p></li>
</ul>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>We will demonstrate the time-dependence of an electron initially described by a Gaussian wavepacket that is travelling between two infinitely tall potential walls located at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x = L\)</span>.  The initial state of this wavepacket will be given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-16653163-ae8f-4fdd-9fa0-a65d3948e64d">
<span class="eqno">(15)<a class="headerlink" href="#equation-16653163-ae8f-4fdd-9fa0-a65d3948e64d" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Psi(x,t_0) = \frac{1}{\sigma \sqrt(2\pi)} {\rm exp}\left(\frac{-1}{2}\left(\frac{x-x_0}{\sigma}\right)^2\right) {\rm exp}(i k_0 x). \tag{1}
\end{equation}\]</div>
<p>Such a wavefunction describes a particle initially with a mean momentum and position of <span class="math notranslate nohighlight">\(\hbar k_0\)</span> and <span class="math notranslate nohighlight">\(x_0\)</span>, respectively, and <span class="math notranslate nohighlight">\(\sigma\)</span> relates to the spread (or position uncertainty)
of the particle.  In the code that follows, we will have <span class="math notranslate nohighlight">\(x_0 = 200\)</span>, <span class="math notranslate nohighlight">\(k_0 = 0.4\)</span>, and <span class="math notranslate nohighlight">\(\sigma = 15\)</span> atomic units.  We will specify that the location of the left-most infinite potential is at <span class="math notranslate nohighlight">\(L = 500\)</span> atomic units.  We will use the fact that we can we can expand this wavefunction in any complete basis, and we will use the basis of the energy eigenfunctions of the particle in a box with <span class="math notranslate nohighlight">\(L = 500\)</span> atomic units.</p>
<p>Hence, we will expand the wavefunction as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6ce05e69-4f61-477e-b4a0-ec37e8c79c19">
<span class="eqno">(16)<a class="headerlink" href="#equation-6ce05e69-4f61-477e-b4a0-ec37e8c79c19" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Psi(x,t) = \sum_{n=1}^N c_n \sqrt{\frac{2}{L}} {\rm sin}\left( \frac{n \pi x}{L} \right)
{\rm exp}\left(-\frac{i E_n t}{\hbar}\right), \tag{2}
\end{equation}\]</div>
<p>where we have used the known time-dependence of each energy eigenstate.  The energy eigenvalues have the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-e633aeae-16b4-470f-8d85-f6006f9d8d39">
<span class="eqno">(17)<a class="headerlink" href="#equation-e633aeae-16b4-470f-8d85-f6006f9d8d39" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_n = \frac{n^2 \pi^2 \hbar^2}{2 m L^2}. \tag{3}
\end{equation}\]</div>
<p>Since we are working in atomic units, <span class="math notranslate nohighlight">\(\hbar\)</span> and <span class="math notranslate nohighlight">\(m\)</span> will have the value of 1.</p>
<p>The coefficients for the above expansion can be determined simply by</p>
<div class="amsmath math notranslate nohighlight" id="equation-f1c6ad88-8c8c-4b81-ab57-8217f35047a5">
<span class="eqno">(18)<a class="headerlink" href="#equation-f1c6ad88-8c8c-4b81-ab57-8217f35047a5" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_n = \sqrt{\frac{2}{500}} \int_0^{500} {\rm sin}\left(\frac{n \pi x}{500}\right) \cdot \Psi(x,t_0) \: dx \tag{4}
\end{equation}\]</div>
<p>where we have set <span class="math notranslate nohighlight">\(L = 500\)</span>.  We will use the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> function <code class="docutils literal notranslate"><span class="pre">trapz(fx,</span> <span class="pre">x)</span></code> to perform a trapezoid rule approximation to
this integral.</p>
</section>
<section id="step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">
<h2>Step 0:  Import libraries and initialize a plot object for the animation<a class="headerlink" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt

from matplotlib import animation, rc
from IPython.display import HTML


# First set up the figure, the axis, and the plot element we want to animate
fig, ax = plt.subplots()
plt.close()

### parameters for the gaussian wavepacket and the PIB functions
x0 = 200
sig = 15
k0 = 0.4
L = 500

### grid of x values for the functions
x = np.linspace(0,500,500)

### parameters for plot
ax.set_xlim((0, L))
ax.set_ylim((-0.03, 0.03))

line, = ax.plot([], [], lw=2)

# initialization function: plot the background of each frame
def init():
    line.set_data([], [])
    return (line,)
</pre></div>
</div>
</div>
</div>
<section id="step-1-define-helper-functions-that-will-compute-the-pib-basis-functions-and-energy-eigenvalues">
<h3>Step 1: Define helper functions that will compute the PIB basis functions and energy eigenvalues<a class="headerlink" href="#step-1-define-helper-functions-that-will-compute-the-pib-basis-functions-and-energy-eigenvalues" title="Permalink to this headline">#</a></h3>
<p>It will be helpful to have helper functions that will evaluate the energy eigenfunctions and eigenvalues of the
particle in a box given the quantum number <span class="math notranslate nohighlight">\(n\)</span>, the length of the box <span class="math notranslate nohighlight">\(L\)</span>, and the grid of <span class="math notranslate nohighlight">\(x\)</span> values for the eigenfunction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def energy_eigenvalue(n, L):
    &quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box and the length 
        of the box L and return the energy eigenvalue in atomic units.  This assumes the mass of the particle
        is 1 in atomic units (i.e. it assumes the particle is an electron).
        The length should be in atomic units.
        
    Arguments
    ---------
    n : int
        the quantum state of the particle in a box
        
    L : float
        the length of the box in atomic units
    &quot;&quot;&quot;
        
    return n ** 2 * np.pi ** 2 / ( 2 * m * L ** 2)

def energy_eigenfunction(n, L, x):
    &quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box, the length 
        of the box L, and x-coordinate value(s) (single value or list) and return the corresponding
        energy eigenstate value(s) of the ordinary particle in a box.  L and x should be in atomic units,
        and the maximum value of x should be L.
        
    Arguments
    ---------
    n : int
        the quantum state of the particle in a box      
    L : float
        the length of the box in atomic units
    x : float (or numpy array of floats)
        the position variable for the energy eigenstate in atomic units
    &quot;&quot;&quot;
    return np.sqrt(2 / L) * np.sin(n * np.pi * x / L)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-define-a-helper-function-that-will-compute-values-of-the-gaussian-wavepacket">
<h3>Step 2: Define a helper function that will compute values of the Gaussian wavepacket<a class="headerlink" href="#step-2-define-a-helper-function-that-will-compute-values-of-the-gaussian-wavepacket" title="Permalink to this headline">#</a></h3>
<p>We will define a function to take the <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(x_0\)</span>, and <span class="math notranslate nohighlight">\(k_0\)</span> parameters and <span class="math notranslate nohighlight">\(x\)</span> value(s) that define Eq. (1) and return <span class="math notranslate nohighlight">\(\Psi(x,t_0)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def gaussian_wavepacket(x0, sig, k0, x):
    &quot;&quot;&quot; Helper function to take the the spread (sig), mean wavenumber (k0), mean position value (x0) 
        and grid of x-values (x) and return the corresponding Gaussian wavepacket values evaluated on that grid
        
    Arguments
    ---------
    x0 : float
        mean position of the wavepacket in atomic units    
    sig : float
        spread of the wavepacket in atomic units
    k0  : float
        the mean wavenumber in atomic units of the wavepacket, related to
        mean momentum by \hbar k0
    x : float (or numpy array of floats)
        the position variable for the energy eigenstate in atomic units
    &quot;&quot;&quot;
    ci = 0+1j # &lt;== the imaginary unit
    pre = 1 / (sig * np.sqrt(2 * np.pi)) # &lt;== prefactor
    gauss = np.exp(-0.5 * ((x - x0) / sig) ** 2) # &lt;== gaussian envelope
    plane = np.exp(ci * k0 * x) # &lt;== plane-wave component
    return pre * gauss * plane
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-set-up-plot-and-function-parameters-and-form-the-gaussian-wavepacket-at-time-t-t0">
<h3>Step 3: Set up plot and function parameters and form the Gaussian Wavepacket at time t=t0<a class="headerlink" href="#step-3-set-up-plot-and-function-parameters-and-form-the-gaussian-wavepacket-at-time-t-t0" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>### Compute the Gaussian wavepacket
psi_gp = gaussian_wavepacket(x, x0, sig, k0)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-write-helper-functions-so-that-the-wavepacket-can-be-expanded-in-the-pib-basis">
<h3>Step 2: Write helper functions so that the wavepacket can be expanded in the PIB basis<a class="headerlink" href="#step-2-write-helper-functions-so-that-the-wavepacket-can-be-expanded-in-the-pib-basis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># function PIB that takes the length-of-box L, the quantum number n, and array of x values x
# and returns the corresponding PIB energy eigenfunction
def PIB(L, n, x):
    return np.sqrt(2/L) * np.sin(n * np.pi * x/L)

### return energy in atomic units
def PIB_En(L, n):
    return n**2 * np.pi**2 /(2 * L**2)

### return time-dependent part of energy eigenfunction in atomic units
def PIB_Time(L, n, t):
    ci = 0+1j
    En = PIB_En(L, n)
    return np.exp(-ci*En*t) 

def dfdx(fx, x):
    dx = x[1]-x[0]
    fxp = np.zeros_like(fx)
    for i in range(0,len(fx)-1):
        fxp[i] = (fx[i+1]-fx[i])/dx
    return fxp


### use rectangle rule to integrate a function!
def integrate(x, f_of_x):
    ### get the width of each rectangle!
    w = x[1]-x[0]
    integral = 0
    for i in range(1,len(x)):
        h = f_of_x[i]
        A = w * h
        integral = integral + A
        
    return integral

</pre></div>
</div>
</div>
</div>
<section id="step-3-determine-the-expansion-coefficients-for-the-gaussian-wavepacket-in-the-pib-basis">
<h4>Step 3:  Determine the expansion coefficients for the Gaussian Wavepacket in the PIB basis<a class="headerlink" href="#step-3-determine-the-expansion-coefficients-for-the-gaussian-wavepacket-in-the-pib-basis" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>### Create an array of quantum numbers for the PIB states... 1 to 100 should be adequate
n_array = np.linspace(1,100,100)
### Each quantum number n has a corresponding (complex) coefficient c_n 
cn_array = np.zeros(len(n_array),dtype=complex)

for i in range(0,100):
    ### get energy eigenstate n
    psi = PIB(L,n_array[i],x)
    ### multiply psi_n by gaussian wavepacket
    integrand = np.conj(psi)*Psi_gp
    ### get coefficient c_n from the integral of psi_n * Psi_gp
    cn_array[i] = integrate(x, integrand)


</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">psi</span> <span class="o">=</span> <span class="n">PIB</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">n_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1">### multiply psi_n by gaussian wavepacket</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">integrand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">*</span><span class="n">Psi_gp</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="c1">### get coefficient c_n from the integral of psi_n * Psi_gp</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">cn_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">integrand</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;Psi_gp&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="step-4-put-it-all-together-and-animate">
<h3>Step 4: Put it all together and animate!<a class="headerlink" href="#step-4-put-it-all-together-and-animate" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>N_time = 300
p_of_t = np.zeros(N_time,dtype=complex)
p2_of_t = np.zeros(N_time, dtype=complex)
p_sig_of_t = np.zeros(N_time,dtype=complex)
y = np.zeros(len(x),dtype=complex)
t = np.zeros(N_time)
for j in range(0,100):
    ft = PIB_Time(L, n_array[j], i*10.)
    fx = PIB(L, n_array[j], x)
    y = y + cn_array[j] * fx * ft

p, p2, sig_p = Momentum_Uncertainty(y, x)
p_of_t[0] = p
p2_of_t[0] = p2 
p_sig_of_t[0] = sig_p 

# animation function. This is called sequentially  
def animate(i):
    y = np.zeros(len(x),dtype=complex)
    for j in range(0,100):
        ft = PIB_Time(L, n_array[j], i*10.)
        fx = PIB(L, n_array[j], x)
        y = y + cn_array[j] * fx * ft
    t[i] = i*10
    p, p2, sig_p = Momentum_Uncertainty(y, x)
    p_of_t[i] = p 
    p2_of_t[i] = p2  
    p_sig_of_t[i] = sig_p 
    line.set_data(x, np.real(y))
    return (line,)
  

anim = animation.FuncAnimation(fig, animate, init_func=init,
                             frames=N_time, interval=100, blit=True)

# Note: below is the part which makes it work on Colab
rc(&#39;animation&#39;, html=&#39;jshtml&#39;)
anim
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.plot(t, np.real(p2_of_t)/max(p2_of_t), &#39;red&#39;, label=&#39;&lt;p^2&gt;&#39;)
plt.plot(t, np.real(p_of_t)/max(np.real(p_of_t)), &#39;blue&#39;, label=&#39;&lt;p&gt;&#39;)
#plt.plot(t, np.real(p_sig_of_t), &#39;green&#39;, label=&#39;sigma_p&#39;)
plt.legend()
plt.show()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def Momentum_Expectation(Psi, x):
    ci=0+1j
    Psi_star = np.conj(Psi)
    Psi_p = dfdx(Psi, x)
    num_integrand = -ci*Psi_star * Psi_p
    den_integrand = Psi_star * Psi
    num = integrate(x, num_integrand)
    den = integrate(x, den_integrand)
    return num/den

def Momentum_Squared_Expectation(Psi, x):
    ci=0+1j
    Psi_star = np.conj(Psi)
    Psi_p = dfdx(Psi, x)
    Psi_pp = dfdx(Psi_p,x)
    num_integrand = -1*Psi_star * Psi_pp
    den_integrand = Psi_star * Psi
    num = integrate(x, num_integrand)
    den = integrate(x, den_integrand)
    return num/den

def Momentum_Uncertainty(Psi, x):
    p = Momentum_Expectation(Psi, x)
    p2 = Momentum_Squared_Expectation(Psi,x)
    return p, p2, np.sqrt(p2 - p**2)




</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="reference-link">
<h1>Reference Link<a class="headerlink" href="#reference-link" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="http://tiao.io/posts/notebooks/embedding-matplotlib-animations-in-jupyter-as-interactive-javascript-widgets/">http://tiao.io/posts/notebooks/embedding-matplotlib-animations-in-jupyter-as-interactive-javascript-widgets/</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ESCIP/escip.github.io",
            ref: "jbook",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="linear_variational_method.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Linear Variational Method</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ESCIP Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>