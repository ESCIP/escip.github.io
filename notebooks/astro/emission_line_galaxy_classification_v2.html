

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Emission Line Galaxy Classification &#8212; ESCIP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/astro/emission_line_galaxy_classification_v2';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SDSS Tutorial #1: Data Querying and Visualization" href="sdss_tutorial_1.html" />
    <link rel="prev" title="Star Formation in Galaxies" href="star_formation_v3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="ESCIP - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="ESCIP - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../team.html">Team</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../guidelines/intro.html">Guidelines</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../guidelines/guidelines.html">Format of notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guidelines/contribute.html">Contributing to ESCIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guidelines/template.html">Template notebook</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../workshops/intro.html">Workshops</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../workshops/workshop2024.html">Spring 2024 In-Person ESCIP Workshop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workshops/workshop2023.html">January 2023 In-Person Workshop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workshops/workshop2022.html">Summer 2022 In-Person Workshop</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="astro.html">Astronomy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="star_formation_v3.html">Star Formation in Galaxies</a></li>








<li class="toctree-l2 current active"><a class="current reference internal" href="#">Emission Line Galaxy Classification</a></li>







<li class="toctree-l2"><a class="reference internal" href="sdss_tutorial_1.html">SDSS Tutorial #1:  Data Querying and Visualization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chem/chem.html">Chemistry</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chem/langevin-dynamics-results.html">Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chem/openmm_lj_chain.html">Simulating toy polymers using openMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chem/linear_variational_method.html">Linear Variational Method</a></li>

<li class="toctree-l2"><a class="reference internal" href="../chem/gaussian_wavepacket.html">Time evolution of a Gaussian wavepacket</a></li>

<li class="toctree-l2"><a class="reference internal" href="../chem/pib_delta_potential_dynamics.html">Dynamics of particle in a box with a delta potential</a></li>



<li class="toctree-l2"><a class="reference internal" href="../chem/carbonyl_binary_classification.html">Carbonyl Binary Classification</a></li>









<li class="toctree-l2"><a class="reference internal" href="../chem/CO_Fundamental.html">Computing Fundamental Transition of CO under different levels of approximation</a></li>


<li class="toctree-l2"><a class="reference internal" href="../chem/Spin_one_half_solutions.html">Introduction to Spin 1/2 Using NumPy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../phys/phys.html">Physics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../phys/fourier_transform.html">Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phys/modelfit_part1.html">Fitting Models to Data (Part 1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phys/modelfit_part2.html">Fitting Models to Data (Part 2)</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ESCIP/escip.github.io/jbook?urlpath=lab/tree/notebooks/astro/emission_line_galaxy_classification_v2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/ESCIP/escip.github.io/blob/jbook/notebooks/astro/emission_line_galaxy_classification_v2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ESCIP/escip.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ESCIP/escip.github.io/issues/new?title=Issue%20on%20page%20%2Fnotebooks/astro/emission_line_galaxy_classification_v2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/astro/emission_line_galaxy_classification_v2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Emission Line Galaxy Classification</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Emission Line Galaxy Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-sample-of-galaxies">Choosing a sample of galaxies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-emission-lines-to-find-active-galaxies">Using emission lines to find active galaxies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-diagrams">Diagnostic Diagrams</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-agn-sf-demarcations">Adding AGN/SF demarcations</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#justifying-diagnostic-diagrams-with-models">Justifying diagnostic diagrams with models</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bpt-diagram">The BPT Diagram</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-up-questions">Follow Up Questions</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="emission-line-galaxy-classification">
<h1>Emission Line Galaxy Classification<a class="headerlink" href="#emission-line-galaxy-classification" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://facstaff.elon.edu/crichardson17/">Chris Richardson, Elon University</a></p>
<p><i>Funding for this tutorial made possible through the <a class="reference external" href="https://www.elon.edu/u/academics/catl/sotl/catl-scholars-program/">CATL Scholars Program</a></i></p>
<p><i>This tutorial is intended for students to complete in groups. A version with solutions is available to instructors upon <a href="mailto:crichardson17@elon.edu">request</a>.</i></p>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>To explore classifying emission line galaxies according to the radiation source excitating gaseous clouds within each galaxy</p></li>
<li><p>To understand how emission line ratios can help constrain excitation mechanisms</p></li>
<li><p>To explore how models can highlight the strengths and weakness of various diagnostic diagrams</p></li>
<li><p>To provide a foundation to explore your own questions about excitation mechanisms in galaxies</p></li>
</ul>
</section>
<section id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this heading">#</a></h2>
<p>By the end of this tutorial you should be able to:</p>
<ul class="simple">
<li><p>Use emission line ratios to explore their diagnostic potential for finding AGN</p></li>
<li><p>Use diagnostic diagrams to demarcate AGN and SF boundaries</p></li>
<li><p>Use photoionization models to test the validity of diagnostic diagrams</p></li>
</ul>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Computational</p>
<ul>
<li><p>Basic Python skills (e.g., for loops, conditional statements, defining functions)</p></li>
<li><p>Basics of <code>matplotlib</code> visualization and SQL queries (e.g., see <a class="reference external" href="https://escip.io/notebooks/sdss_tutorial_1.html">here</a>)</p></li>
<li><p>Using the <code><a class="reference external" href="https://docs.astropy.org/en/stable/units/index.html">astropy</a></code> package for fundamental constants and unit conversion</p></li>
</ul>
</li>
<li><p>Astrophysics</p>
<ul>
<li><p>Introductory knowledge of the formation of <a class="reference external" href="https://openstax.org/books/astronomy-2e/pages/5-5-formation-of-spectral-lines">spectral lines</a></p></li>
<li><p>Basic understanding of the physical picture present in <a class="reference external" href="http://skyserver.sdss.org/edr/en/proj/advanced/galaxies/spectra.asp">star forming galaxies</a> and <a class="reference external" href="https://imagine.gsfc.nasa.gov/science/objects/active_galaxies1.html">active galaxies</a> (i.e., AGN)</p></li>
<li><p>Advanced conceptual understanding of using emission lines to probe spectral energy distributions</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import relevant libraries</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># data analysis </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># more data analysis</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># plotting library</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> <span class="c1"># another plotting library</span>
<span class="kn">from</span> <span class="nn">astroquery.sdss</span> <span class="kn">import</span> <span class="n">SDSS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># data analysis </span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># more data analysis</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># plotting library</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> <span class="c1"># another plotting library</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">astroquery.sdss</span> <span class="kn">import</span> <span class="n">SDSS</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;seaborn&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make notebook have a clean appearance</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="choosing-a-sample-of-galaxies">
<h1>Choosing a sample of galaxies<a class="headerlink" href="#choosing-a-sample-of-galaxies" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="http://skyserver.sdss.org/dr16/en/help/browser/browser.aspx#&amp;&amp;history=description+galSpecLine+U"><code>GalSpecLine</code></a> and <a class="reference external" href="http://skyserver.sdss.org/dr16/en/help/browser/browser.aspx#&amp;&amp;history=description+emissionLinesPort+U"><code>emissionLinesPort</code></a> are examples of two schema available to search for emission line galaxies. The most common emission lines are featured in both schema, but there are several lines not cross listed between the two catalogs. The methods used for measuring the emission line strengths differ between the catalogs, each with their unique merits. We will use <a class="reference external" href="http://skyserver.sdss.org/dr16/en/help/browser/browser.aspx#&amp;&amp;history=description+galSpecLine+U">GalSpecLine</a> for this tutorial, however <code>emissionLinesPort</code> could be used in a follow up project.</p>
<p>While you can include as many or as little emission lines as you’d like in your query, you should always include the emission line flux errors and the galaxy redshifts. The errors on the emission line measurements enable you to improve the quality of your sample if only specific emission lines interest you. It is better to impose these restrictions after your query as it can dramatically reduce the sample size. The redshift of each galaxy is important because certain emission lines will shift into and outside the SDSS window of observation.</p>
<ul class="simple">
<li><p>At what <span class="math notranslate nohighlight">\(z\)</span> will the shortest wavelength emission line shift into the observation window?</p></li>
<li><p>At what <span class="math notranslate nohighlight">\(z\)</span> will the longest wavelength emission line shift outside the observation window?</p></li>
</ul>
<p>The SDSS aperture is fixed in size and is typically aligned with the nuclear center of each galaxy.</p>
<ul class="simple">
<li><p>How might the size of the SDSS aperture tie into your ability to discern galaxy wide properties at certain redshifts?</p></li>
<li><p>What sort of bias does this introduce into your results?</p></li>
</ul>
<p><b>Your answers to these questions:</b>
<br>
<br>
<br>
<br>
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a query to generate a sample of galaxies</span>

<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;SELECT TOP 10000 s.plate, s.fiberid, s.mjd, s.z, s.zwarning, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oii_3726_flux, g.oii_3729_flux, &#39;</span> <span class="c1">#-- Gather possible emission lines of interest</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.neiii_3869_flux, g.h_delta_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_gamma_flux, g.oiii_4363_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_beta_flux, g.oiii_4959_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oiii_5007_flux, g.hei_5876_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oi_6300_flux, g.nii_6548_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_alpha_flux, g.nii_6584_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.sii_6717_flux, g.sii_6731_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.ariii7135_flux, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oii_3726_flux_err, g.oii_3729_flux_err, &#39;</span> <span class="c1">#-- Gather emission line errors</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.neiii_3869_flux_err, g.h_delta_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_gamma_flux_err, g.oiii_4363_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_beta_flux_err, g.oiii_4959_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oiii_5007_flux_err, g.hei_5876_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.oi_6300_flux_err, g.nii_6548_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.h_alpha_flux_err, g.nii_6584_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.sii_6717_flux_err, g.sii_6731_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;g.ariii7135_flux_err, &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;e.bptclass &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;FROM GalSpecLine AS g, SpecObj AS s, GalSpecExtra AS e &#39;</span> 
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;WHERE &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;s.specobjid = g.specobjid &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND s.specobjid = e.specobjid &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND z BETWEEN 0.04 and 0.1 &#39;</span><span class="c1">#-- Lower limit needed for global parameters w/ small aperture</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND h_alpha_flux &gt; h_alpha_flux_err*5 &#39;</span> <span class="c1">#-- Make sure Balmer lines have adequate S/N</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND h_beta_flux &gt; h_beta_flux_err*5 &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND h_alpha_flux_err &gt; 0 &#39;</span> <span class="c1">#-- Consistency check</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND h_beta_flux_err &gt; 0 &#39;</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND sigma_balmer &lt; 509.55 &#39;</span> <span class="c1">#-- Exclude the broad line emitting galaxies</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND s.class = </span><span class="se">\&#39;</span><span class="s1">GALAXY</span><span class="se">\&#39;</span><span class="s1"> &#39;</span>  <span class="c1">#-- Looking for galaxies, not stars</span>
<span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39;AND s.zwarning = 0 &#39;</span>
<span class="c1">#print (query) # useful for debugging, remove first # to uncomment</span>

<span class="c1"># send query to SDSS</span>
<span class="n">gals</span> <span class="o">=</span> <span class="n">SDSS</span><span class="o">.</span><span class="n">query_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">data_release</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">gals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>plate</th>
      <th>fiberid</th>
      <th>mjd</th>
      <th>z</th>
      <th>zwarning</th>
      <th>oii_3726_flux</th>
      <th>oii_3729_flux</th>
      <th>neiii_3869_flux</th>
      <th>h_delta_flux</th>
      <th>h_gamma_flux</th>
      <th>...</th>
      <th>oiii_5007_flux_err</th>
      <th>hei_5876_flux_err</th>
      <th>oi_6300_flux_err</th>
      <th>nii_6548_flux_err</th>
      <th>h_alpha_flux_err</th>
      <th>nii_6584_flux_err</th>
      <th>sii_6717_flux_err</th>
      <th>sii_6731_flux_err</th>
      <th>ariii7135_flux_err</th>
      <th>bptclass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>266</td>
      <td>4</td>
      <td>51630</td>
      <td>0.064656</td>
      <td>0</td>
      <td>39.057380</td>
      <td>27.096570</td>
      <td>2.468194</td>
      <td>6.669699</td>
      <td>12.437470</td>
      <td>...</td>
      <td>3.302969</td>
      <td>2.745098</td>
      <td>2.520172</td>
      <td>1.046200</td>
      <td>3.448143</td>
      <td>3.155578</td>
      <td>2.919328</td>
      <td>2.860605</td>
      <td>4.992754</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>266</td>
      <td>120</td>
      <td>51630</td>
      <td>0.069341</td>
      <td>0</td>
      <td>-1.330543</td>
      <td>7.919315</td>
      <td>-0.333586</td>
      <td>-1.529107</td>
      <td>10.477300</td>
      <td>...</td>
      <td>2.545394</td>
      <td>1.778672</td>
      <td>1.680469</td>
      <td>0.703648</td>
      <td>2.371513</td>
      <td>2.122362</td>
      <td>2.055846</td>
      <td>1.841887</td>
      <td>3.126379</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>266</td>
      <td>146</td>
      <td>51630</td>
      <td>0.052176</td>
      <td>0</td>
      <td>145.169700</td>
      <td>184.163200</td>
      <td>26.046470</td>
      <td>67.026570</td>
      <td>114.044300</td>
      <td>...</td>
      <td>4.271465</td>
      <td>3.850465</td>
      <td>3.498755</td>
      <td>2.040700</td>
      <td>10.994270</td>
      <td>6.155217</td>
      <td>4.846725</td>
      <td>4.428813</td>
      <td>3.586765</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>266</td>
      <td>533</td>
      <td>51630</td>
      <td>0.085351</td>
      <td>0</td>
      <td>31.840760</td>
      <td>28.041630</td>
      <td>2.403825</td>
      <td>12.097370</td>
      <td>18.920390</td>
      <td>...</td>
      <td>2.793131</td>
      <td>1.910691</td>
      <td>1.961116</td>
      <td>0.822471</td>
      <td>3.265500</td>
      <td>2.480760</td>
      <td>2.806020</td>
      <td>2.475492</td>
      <td>2.315306</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>266</td>
      <td>630</td>
      <td>51630</td>
      <td>0.073687</td>
      <td>0</td>
      <td>12.878990</td>
      <td>21.359510</td>
      <td>3.436489</td>
      <td>0.142290</td>
      <td>5.390950</td>
      <td>...</td>
      <td>1.988206</td>
      <td>1.574178</td>
      <td>1.350679</td>
      <td>0.568662</td>
      <td>2.131675</td>
      <td>1.715214</td>
      <td>1.609602</td>
      <td>1.671389</td>
      <td>1.910809</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1207</td>
      <td>463</td>
      <td>52672</td>
      <td>0.055911</td>
      <td>0</td>
      <td>-0.273259</td>
      <td>21.205140</td>
      <td>0.332328</td>
      <td>6.859152</td>
      <td>4.029799</td>
      <td>...</td>
      <td>2.268165</td>
      <td>2.104548</td>
      <td>1.901967</td>
      <td>0.799355</td>
      <td>2.466196</td>
      <td>2.411038</td>
      <td>2.136849</td>
      <td>2.025468</td>
      <td>2.065840</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1207</td>
      <td>512</td>
      <td>52672</td>
      <td>0.040428</td>
      <td>0</td>
      <td>168.423800</td>
      <td>208.261600</td>
      <td>16.263230</td>
      <td>33.077510</td>
      <td>53.475750</td>
      <td>...</td>
      <td>3.645575</td>
      <td>2.059486</td>
      <td>1.995668</td>
      <td>0.826124</td>
      <td>5.905511</td>
      <td>2.491776</td>
      <td>2.573609</td>
      <td>2.407138</td>
      <td>1.849287</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>1208</td>
      <td>202</td>
      <td>52672</td>
      <td>0.051229</td>
      <td>0</td>
      <td>75.635860</td>
      <td>81.785600</td>
      <td>4.387515</td>
      <td>17.040500</td>
      <td>28.414330</td>
      <td>...</td>
      <td>3.219081</td>
      <td>2.728835</td>
      <td>2.423338</td>
      <td>1.162954</td>
      <td>4.954031</td>
      <td>3.507735</td>
      <td>3.237844</td>
      <td>3.007984</td>
      <td>2.462693</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>1208</td>
      <td>490</td>
      <td>52672</td>
      <td>0.093831</td>
      <td>0</td>
      <td>37.472160</td>
      <td>44.705480</td>
      <td>2.661830</td>
      <td>16.227150</td>
      <td>30.224240</td>
      <td>...</td>
      <td>2.448881</td>
      <td>1.810508</td>
      <td>1.965327</td>
      <td>0.843513</td>
      <td>4.036311</td>
      <td>2.544227</td>
      <td>2.512585</td>
      <td>2.451001</td>
      <td>2.777650</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>1208</td>
      <td>593</td>
      <td>52672</td>
      <td>0.071304</td>
      <td>0</td>
      <td>71.641330</td>
      <td>85.087980</td>
      <td>5.179615</td>
      <td>23.398060</td>
      <td>36.458060</td>
      <td>...</td>
      <td>2.943066</td>
      <td>2.206493</td>
      <td>2.083630</td>
      <td>1.008152</td>
      <td>4.212832</td>
      <td>3.040816</td>
      <td>2.661236</td>
      <td>2.490553</td>
      <td>2.830445</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 40 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="using-emission-lines-to-find-active-galaxies">
<h1>Using emission lines to find active galaxies<a class="headerlink" href="#using-emission-lines-to-find-active-galaxies" title="Permalink to this heading">#</a></h1>
<p>In the lecture-tutorial on emission line ratio diagnostics, you discovered how to find emission line ratios sensitive to the excitation source. In summary, ratios featuring emission lines with relatively different ionization potentials effectively probe the shape of the ionizing radiation field and therefore the excitation source (e.g., starlight, AGN).</p>
<p>As a trial run, let’s explore how well the emission line ratio [O II] <span class="math notranslate nohighlight">\(\lambda\)</span>3727 / [Ne III] <span class="math notranslate nohighlight">\(\lambda\)</span>3869 separates star forming (SF) galaxies and AGN. N.B. [O II] <span class="math notranslate nohighlight">\(\lambda\)</span>3727 is actually the sum of the [O II] <span class="math notranslate nohighlight">\(\lambda\)</span>3726 and [O II] <span class="math notranslate nohighlight">\(\lambda\)</span>3729 doublet.</p>
<ul class="simple">
<li><p>What are relavent ionization potentials for [O II] and [Ne III] line emission?</p></li>
<li><p>Would you expect AGN to display higher or lower [O II]/[Ne III] ratios compared to SF galaxies?</p></li>
</ul>
<p><b>Your answers to these questions:</b>
<br>
<br>
<br>
<br>
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove possible +/- inf values</span>
<span class="n">gals_flux</span> <span class="o">=</span> <span class="n">gals</span><span class="p">[(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;neiii_3869_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;oii_3726_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;oii_3729_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> 
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;oi_6300_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]</span>

<span class="c1"># Make sure relavent emission lines have well measured fluxes</span>
<span class="n">quality_gals</span> <span class="o">=</span> <span class="n">gals_flux</span><span class="p">[(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;neiii_3869_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;neiii_3869_flux_err&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oii_3726_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oii_3726_flux_err&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oii_3729_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oii_3729_flux_err&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oi_6300_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oi_6300_flux_err&#39;</span><span class="p">])]</span>

<span class="c1"># Split the sample into AGN and SF galaxies</span>
<span class="n">gals_sf</span> <span class="o">=</span> <span class="n">quality_gals</span><span class="p">[</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gals_agn</span> <span class="o">=</span> <span class="n">quality_gals</span><span class="p">[(</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">)]</span>

<span class="n">oii_doublet_sf</span> <span class="o">=</span> <span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;oii_3726_flux&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;oii_3729_flux&#39;</span><span class="p">]</span>
<span class="n">oii_doublet_agn</span> <span class="o">=</span> <span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;oii_3726_flux&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;oii_3729_flux&#39;</span><span class="p">]</span>

<span class="n">oii_neiii_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">oii_doublet_sf</span><span class="o">/</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;neiii_3869_flux&#39;</span><span class="p">])</span>
<span class="n">oii_neiii_agn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">oii_doublet_agn</span><span class="o">/</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;neiii_3869_flux&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">oii_neiii_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">oii_neiii_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1">#plt.title(&#39;[O II]/[Ne III] as a function of galaxy classification&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;[O II]/[Ne III]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/99651d089d73e9155e2e11a8a92cb82b741adc258a9f20b1a3c443654925d8a4.png" src="../../_images/99651d089d73e9155e2e11a8a92cb82b741adc258a9f20b1a3c443654925d8a4.png" />
</div>
</div>
<p>The histogram shows the number of galaxies in each bin as a function of galaxy classification. It is useful in telling us that the <span class="math notranslate nohighlight">\(N_{SF}\)</span> &gt; <span class="math notranslate nohighlight">\(N_{AGN}\)</span> and that each distribution peaks at a differnt [O II]/[Ne III]. But, the actual location of those peaks is bit uncertain because the histogram is rather blocky.</p>
<p>The Python package <code>matplotlib</code> will try to select a bin width that results in a visually appealing histogram. We can adjust the number of bins, and therefore the bin width, using the “bins” kwarg. However, histograms will always appear bumpy and depend upon the endpoints of the bins. One way around this is to use a Keneral Density Estimator (KDE) plot, which you can read about <a class="reference external" href="https://towardsdatascience.com/histograms-vs-kdes-explained-ed62e7753f12">here</a>. We can use the “seaborn” package to make publicaton quality KDE plots that show a smooth distribution of our data. The plot now shows the <i>density</i> of galaxies rather than the <i>number</i> of galaxies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">oii_neiii_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">oii_neiii_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;[O II]/[O III]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1dd431ba95a702c93284adc7838185ca57e3d1f617349ab922bcdb55df7f2917.png" src="../../_images/1dd431ba95a702c93284adc7838185ca57e3d1f617349ab922bcdb55df7f2917.png" />
</div>
</div>
<p>The KDE plot of [O II]/[Ne III] shows that no matter how we slice it, this ratio alone is not capable of separating SF and AGN excitation in galaxies. Let’s assess the ability of [O III] <span class="math notranslate nohighlight">\(\lambda\)</span>5007 /[O I] <span class="math notranslate nohighlight">\(\lambda\)</span>6300 to act as an effective excitation diagnostic. Try generating a KDE plot for this emission line ratio in the space below and ask yourself the following questions.</p>
<ul class="simple">
<li><p>What are relavent ionization potentials for [O III] and [O I] line emission?</p></li>
<li><p>Would you expect AGN to display higher or lower [O III]/[O I] ratios compared to SF galaxies?</p></li>
<li><p>Can you make a single cut to separate all galaxies with an AGN from those only experiencing SF?</p></li>
</ul>
<p><b>Your answers to these questions:</b>
<br>
<br>
<br>
<br>
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code for KDE plot</span>
<span class="c1">#oiii_oi_sf = </span>
<span class="c1">#oiii_oi_agn = </span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="diagnostic-diagrams">
<h1>Diagnostic Diagrams<a class="headerlink" href="#diagnostic-diagrams" title="Permalink to this heading">#</a></h1>
<p>We can combine multiple line ratios in a diagram to increase their utility in separating AGN and SF activity. This assesses the shape of the inicident radiation field (starlight or AGN) at more energies than possible with a single emission line ratio. Let’s combine [O II]/[Ne III] and [O III]/[O I] into a single plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_sf</span><span class="p">,</span><span class="n">oiii_oi_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_agn</span><span class="p">,</span><span class="n">oiii_oi_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;[O II]/[Ne III]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[O III]/[O I]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="ne">NameError</span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="n">cf6c5fbac493</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_sf</span><span class="p">,</span><span class="n">oiii_oi_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_agn</span><span class="p">,</span><span class="n">oiii_oi_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;[O II]/[Ne III]&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[O III]/[O I]&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;oiii_oi_sf&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="adding-agn-sf-demarcations">
<h1>Adding AGN/SF demarcations<a class="headerlink" href="#adding-agn-sf-demarcations" title="Permalink to this heading">#</a></h1>
<p>The [O III]/[O I] vs. [O II]/[Ne III] diagram does a reasonable job in separating AGN and SF galaxies. We can make this separation more explicit by adding a demarcation line. Since we might want to generate this plot over and over, we can make define a function that will do it for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_diagram</span><span class="p">():</span>

    <span class="n">o2ne3_demarc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.19</span><span class="p">)</span>
    <span class="n">o3o1_demarc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.055</span> <span class="o">/</span> <span class="p">(</span><span class="n">o2ne3_demarc</span> <span class="o">-</span> <span class="mf">1.19</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.35</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_sf</span><span class="p">,</span><span class="n">oiii_oi_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">oii_neiii_agn</span><span class="p">,</span><span class="n">oiii_oi_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">o2ne3_demarc</span><span class="p">,</span><span class="n">o3o1_demarc</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;[O II]/[Ne III]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[O III]/[O I]&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1.8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1">######    </span>

<span class="n">make_diagram</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="justifying-diagnostic-diagrams-with-models">
<h1>Justifying diagnostic diagrams with models<a class="headerlink" href="#justifying-diagnostic-diagrams-with-models" title="Permalink to this heading">#</a></h1>
<p>Up until this point, we have been using observed galaxies flagged as an AGN or star forming galaxy in the <code>GalSpecExtra</code>. While we would like to take this information for granted, it is important to note these tags are based on a set of assumptions that may or may not hold for all galaxies. We can use photoionization models to understand the limits of these AGN/SF distinctions and our newly created diagnostics diagram.</p>
<p>Photoionization models predict the observed emission line spectrum for gas clouds illuminated by an AGN or starlight in a galaxy. The set that we will use comes from <a class="reference external" href="https://iopscience.iop.org/article/10.3847/1538-4357/ac510c">this paper</a> and a link to the simulated emission region data has been provided on Moodle. To make the visualization easier, we can restrict the model parameter space to regions that we’re interested in exploring. A brief description of the parameters is given below along with accepted values within the grid.</p>
<p><code>LOGU</code> - dimensionaless quantity (ionization parameter) specifying the ionization level of the gas clouds<br />
options: -4.0 to -0.5 in 0.25 increments</p>
<p><code>LOGZ</code> - metallicity of the gas clouds relative to solar metallicity<br />
options: [0.05, 0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.7, 1.0, 1.5, 2.0]</p>
<p><code>AGNFRAC</code> - the fraction of AGN excitation as opposed to starlight excitation<br />
options: [0.0, 0.04, 0.08, 0.16, 0.32, 0.64, 1.0]</p>
<p>Let’s see how the emission line predictions compare to our observed galaxies on the diagnostic diagram when we select a simulation with 100% AGN excitation and Z = 0.2 Z<span class="math notranslate nohighlight">\(_{\odot}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span>--no-check-certificate<span class="w"> </span><span class="s1">&#39;https://drive.google.com/uc?export=download&amp;id=1vQrGvdOf2w9VAu7F0lub5tEAi75cIMm4&#39;</span><span class="w"> </span>-O<span class="w"> </span>model_file

<span class="n">model_grid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;model_file&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="c1">#print (model_grid.columns) # useful to check out the column names in the file</span>

<span class="c1"># function to restrict the model parameter space</span>
<span class="k">def</span> <span class="nf">apply_limits</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">f_agn</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Z</span><span class="p">):</span>
    
    <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[(</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;AGNFRAC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">f_agn</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;LOGZ&#39;</span><span class="p">],</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span> \
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;MIXING&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; coincident&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;LOGU&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;LOGU&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    
    <span class="k">return</span> <span class="n">grid</span>

<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.75</span><span class="p">,</span><span class="o">-</span><span class="mf">2.75</span><span class="p">]</span> <span class="c1"># range of ionization parameter</span>
<span class="n">f_agn</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">agn_models</span> <span class="o">=</span> <span class="n">apply_limits</span><span class="p">(</span><span class="n">model_grid</span><span class="p">,</span><span class="n">f_agn</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
<span class="c1">#print (agn_models)</span>

<span class="n">model_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">O__2_372603A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">O__2_372881A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">NE_3_386876A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">model_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">O__3_500684A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">O__1_630030A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">])</span>

<span class="n">make_diagram</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_x</span><span class="p">,</span><span class="n">model_y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The AGN model assuming 0.2 Z<span class="math notranslate nohighlight">\(_{\odot}\)</span> lies in the AGN part of our diagram and including a range of ionization parameter covers some of the variation in the region. It seems that the models preliminarily suggest the galaxies flagged as AGN really are AGN and the diagnostic diagram can pick them out. In the cells below, determine if this is a robust result by answering the following questions.</p>
<ul class="simple">
<li><p>Do all of the 100% AGN simulations fall within the AGN part of the diagnostic diagram?</p></li>
<li><p>If so, what range of ionization parameters and metallicities do the observed AGN span? If not, what values disagree with our chosen demarcations?</p></li>
<li><p>Do all of the purely SF simulations fall within the SF part of the diagnostic diagram?</p></li>
<li><p>If so, what range of ionization parameters and metallicities do the observed SF galaxies span? If not, what values disagree with our chosen demarcations?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code to answer the questions above</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-bpt-diagram">
<h1>The BPT Diagram<a class="headerlink" href="#the-bpt-diagram" title="Permalink to this heading">#</a></h1>
<p>The diagnostic diagram that we have developed does have it’s limitations. For example, both of the [O II] and [Ne III] emission lines are unavailable for low-<span class="math notranslate nohighlight">\(z\)</span> galaxies because they fall outside the SDSS observing window. This means that we’re unable to identify AGN activity for local galaxies. Another limitation is that some of the emission lines can be rather weak, making a reliable detection difficult. We can quantify this by looking at much our sample reduces down after applying our S/N cut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Fraction of initial SF galaxies included after S/N cut: &#39;</span><span class="p">,</span>
       <span class="s2">&quot;</span><span class="si">{:.3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gals_sf</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">])))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Fraction of initial AGN galaxies included after S/N cut: &#39;</span><span class="p">,</span>
       <span class="s2">&quot;</span><span class="si">{:.3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gals_agn</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>Therein lies the problem: most galaxies only have a handful of reliable emission lines measurements. This is one reason why the diagnostic diagram we have been analyzing isn’t a popular choice in research literature even though it does a reasonable job of distinguishing between AGN and star forming galaxies.</p>
<p>The so-called “gold standard” for classifying AGN with optical spectroscopy is known as the “BPT” diagram, named after the authors that developed it in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1981PASP...93....5B/abstract">this paper</a>. The BPT diagram uses emission line ratios from [O III] <span class="math notranslate nohighlight">\(\lambda\)</span>5007, [N II] <span class="math notranslate nohighlight">\(\lambda\)</span>6584, H<span class="math notranslate nohighlight">\(\beta\)</span>, and H<span class="math notranslate nohighlight">\(\alpha\)</span>, all of which are known as “strong lines” since they’re strong enough to be reliably measured in most galaxies. Using strong lines for diagnostics drastically improves the number of galaxies we can include in a sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gals_flux</span> <span class="o">=</span> <span class="n">gals</span><span class="p">[(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]</span>

<span class="n">quality_gals</span> <span class="o">=</span> <span class="n">gals_flux</span><span class="p">[(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux_err&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.0</span><span class="o">*</span><span class="n">gals_flux</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux_err&#39;</span><span class="p">])]</span>

<span class="n">gals_sf</span> <span class="o">=</span> <span class="n">quality_gals</span><span class="p">[</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="p">(</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">gals_agn</span> <span class="o">=</span> <span class="n">quality_gals</span><span class="p">[(</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">)]</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Fraction of initial SF galaxies included after S/N cut: &#39;</span><span class="p">,</span>
       <span class="s2">&quot;</span><span class="si">{:.3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gals_sf</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">])))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Fraction of initial AGN galaxies included after S/N cut: &#39;</span><span class="p">,</span>
       <span class="s2">&quot;</span><span class="si">{:.3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gals_agn</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">gals</span><span class="p">[</span><span class="n">gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>The BPT diagram remains a hot topic in academic literature today. In fact, the <code>GalSpecExtra</code> schema actually uses the BPT diagram to classify galaxies as AGN or star forming. If we use the standard demarcations from literature, it is no surprise in the plot the below that all of the AGN and star forming galaxies are perfectly separated. There is even an additional class of galaxies known as “composites” that are thought to represent a transition state between purly star forming galaxies and those excited purely by an AGN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_bpt_plot</span><span class="p">():</span>
    
    <span class="n">gals_comp</span> <span class="o">=</span> <span class="n">quality_gals</span><span class="p">[(</span><span class="n">quality_gals</span><span class="p">[</span><span class="s1">&#39;bptclass&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">)]</span>

    <span class="n">oiii_Hb_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;h_beta_flux&#39;</span><span class="p">])</span>
    <span class="n">oiii_Hb_agn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;h_beta_flux&#39;</span><span class="p">])</span>
    <span class="n">oiii_Hb_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_comp</span><span class="p">[</span><span class="s1">&#39;oiii_5007_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_comp</span><span class="p">[</span><span class="s1">&#39;h_beta_flux&#39;</span><span class="p">])</span>

    <span class="n">nii_Ha_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_sf</span><span class="p">[</span><span class="s1">&#39;h_alpha_flux&#39;</span><span class="p">])</span>
    <span class="n">nii_Ha_agn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_agn</span><span class="p">[</span><span class="s1">&#39;h_alpha_flux&#39;</span><span class="p">])</span>
    <span class="n">nii_Ha_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">gals_comp</span><span class="p">[</span><span class="s1">&#39;nii_6584_flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">gals_comp</span><span class="p">[</span><span class="s1">&#39;h_alpha_flux&#39;</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nii_Ha_sf</span><span class="p">,</span><span class="n">oiii_Hb_sf</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nii_Ha_agn</span><span class="p">,</span><span class="n">oiii_Hb_agn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;AGN&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nii_Ha_comp</span><span class="p">,</span><span class="n">oiii_Hb_comp</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Comp&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

    <span class="n">comp_n2ha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">comp_o3hb</span> <span class="o">=</span> <span class="mf">0.61</span><span class="o">/</span><span class="p">(</span><span class="n">comp_n2ha</span><span class="o">-</span><span class="mf">0.05</span><span class="p">)</span><span class="o">+</span><span class="mf">1.3</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp_n2ha</span><span class="p">,</span><span class="n">comp_o3hb</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">agn_n2ha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">agn_o2hb</span> <span class="o">=</span> <span class="mf">0.61</span><span class="o">/</span><span class="p">(</span><span class="n">agn_n2ha</span><span class="o">-</span><span class="mf">0.47</span><span class="p">)</span><span class="o">+</span><span class="mf">1.19</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">agn_n2ha</span><span class="p">,</span><span class="n">agn_o2hb</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[N II]/H$\alpha$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[O III]/H$\beta$&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.25</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1">######</span>
    
<span class="n">make_bpt_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>All of the strong lines on the BPT diagram fall within the SDSS observation window for both local galaxies and those at higher redshifts. Combined with the superior statistics shown above, this makes the BPT diagram a suitable choice for tracing galaxy evolution. We can return to the photoionization models to investigate how a purely star forming model compares to the selected observations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_bpt_plot</span><span class="p">()</span>

<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.75</span><span class="p">,</span><span class="o">-</span><span class="mf">2.75</span><span class="p">]</span>
<span class="n">f_agn</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">agn_models</span> <span class="o">=</span> <span class="n">apply_limits</span><span class="p">(</span><span class="n">model_grid</span><span class="p">,</span><span class="n">f_agn</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>

<span class="c1">#print (model_grid.columns) # useful to check out the column names in the file</span>

<span class="n">model_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">N__2_658345A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">H__1_656281A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">])</span>
<span class="n">model_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">O__3_500684A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">agn_models</span><span class="p">[</span><span class="s1">&#39; </span><span class="se">\&#39;</span><span class="s1">H__1_486133A</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_x</span><span class="p">,</span><span class="n">model_y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Cyan&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>All diagnostic diagrams have their limitations and it is important to keep the limitations in mind when interpreting results. In the space below, use the photionization models to explore the limitations of the BPT diagram in the same way that you previously explored the limitations of the [O III]/[O I] vs. [O II]/[Ne III] diagram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code to compare photoionization models to selected observations</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="follow-up-questions">
<h1>Follow Up Questions<a class="headerlink" href="#follow-up-questions" title="Permalink to this heading">#</a></h1>
<p>Developing new diagnostic diagrams to separate AGN and SF galaxies remains a trendy topic in academic research. This Lecture-Tutorial has laid the foundation for you to investigate this yourself. A sample of potential follow up questions is given below, but don’t let these limit your curiousity.</p>
<ul class="simple">
<li><p>What are the effects of selecting models with non-binary <span class="math notranslate nohighlight">\(f_{AGN}\)</span>?</p></li>
<li><p>We know where BPT classfied AGN lie on the [O III]/[O I] vs. [O II]/[Ne III] diagram, but what about vice-versa, and what does this tell you about using only one diagram to find AGN?</p></li>
<li><p>What other diagrams can effectively seperate AGN and SF galaxies?</p></li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ESCIP/escip.github.io",
            ref: "jbook",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/astro"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="star_formation_v3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Star Formation in Galaxies</p>
      </div>
    </a>
    <a class="right-next"
       href="sdss_tutorial_1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SDSS Tutorial #1:  Data Querying and Visualization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Emission Line Galaxy Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-sample-of-galaxies">Choosing a sample of galaxies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-emission-lines-to-find-active-galaxies">Using emission lines to find active galaxies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-diagrams">Diagnostic Diagrams</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-agn-sf-demarcations">Adding AGN/SF demarcations</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#justifying-diagnostic-diagrams-with-models">Justifying diagnostic diagrams with models</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bpt-diagram">The BPT Diagram</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-up-questions">Follow Up Questions</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ESCIP Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>