

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Dynamics of particle in a box with a delta potential &#8212; ESCIP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/pib_delta_potential_dynamics';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fitting Models to Data (Part 1)" href="modelfit_part1.html" />
    <link rel="prev" title="Time evolution of a Gaussian wavepacket" href="gaussian_wavepacket.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../team.html">Team</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guidelines/intro.html">Guidelines</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guidelines/guidelines.html">Format of notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guidelines/template.html">Template notebook</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../workshops/intro.html">Workshops</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../workshops/workshop2023.html">January 2023 In-Person Workshop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workshops/workshop2022.html">Summer 2022 In-Person Workshop</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fourier_transform.html">Fourier Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_variational_method.html">Linear Variational Method</a></li>

<li class="toctree-l1"><a class="reference internal" href="gaussian_wavepacket.html">Time evolution of a Gaussian wavepacket</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Dynamics of particle in a box with a delta potential</a></li>



<li class="toctree-l1"><a class="reference internal" href="modelfit_part1.html">Fitting Models to Data (Part 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelfit_part2.html">Fitting Models to Data (Part 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdss_tutorial_1.html">SDSS Tutorial #1:  Data Querying and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="carbonyl_binary_classification.html">Carbonyl Binary Classification</a></li>









<li class="toctree-l1"><a class="reference internal" href="star_formation_v2.html">Star Formation in Galaxies</a></li>








<li class="toctree-l1"><a class="reference internal" href="langevin-dynamics-results.html">Langevin Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmm_lj_chain.html">Simulating toy polymers using openMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="emission_line_galaxy_classification_v1.html">Emission Line Galaxy Classification</a></li>







<li class="toctree-l1"><a class="reference internal" href="CO_Fundamental.html">Computing Fundamental Transition of CO under different levels of approximation</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ESCIP/escip.github.io/jbook?urlpath=lab/tree/notebooks/pib_delta_potential_dynamics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/ESCIP/escip.github.io/blob/jbook/notebooks/pib_delta_potential_dynamics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ESCIP/escip.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ESCIP/escip.github.io/issues/new?title=Issue%20on%20page%20%2Fnotebooks/pib_delta_potential_dynamics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/pib_delta_potential_dynamics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dynamics of particle in a box with a delta potential</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Dynamics of particle in a box with a delta potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">Step 0:  Import libraries and initialize a plot object for the animation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerically-solving-the-tdse-part-1-euler-method">Numerically Solving the TDSE Part 1:  Euler Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerically-solving-the-tdse-part-2-runge-kutta-method">Numerically Solving the TDSE Part 2:  Runge-Kutta Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-part-1">Questions Part 1:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-rk4-update-function">Test for rk4_update function</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependence-with-the-delta-potential">Time-dependence with the delta potential</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dynamics-of-particle-in-a-box-with-a-delta-potential">
<h1>Dynamics of particle in a box with a delta potential<a class="headerlink" href="#dynamics-of-particle-in-a-box-with-a-delta-potential" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://foleylab.github.io/">Jay Foley and Lane Tolley, University of North Carolina Charlotte</a></p>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>To demonstrate the use of the numerical methods, including the Euler method and the Runge-Kutta method, to solve the time-dependent Schrodinger equation</p></li>
<li><p>To illustrate the dynamics of a particle in a box with a delta potential</p></li>
</ul>
</section>
<section id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this heading">#</a></h2>
<p>By the end of this workbook, students should be able to</p>
<ul class="simple">
<li><p>Express the time-dependent Schrodinger equation using matrices for the Hamiltonian operator and vectors for the wavefunction</p></li>
<li><p>Utilize matrix-vector operations in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to compte time-derivatives of the wavefunction</p></li>
<li><p>Utilize numerical integration methods, particularly the Euler method and the Runge-Kutta method, to evolve the wavefunction in time.</p></li>
</ul>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>We will investigate the particle in a box with a delta potential that was explored in the notebook on the <a class="reference external" href="https://escip.io/notebooks/linear_variational_method.html">Linear Variational Method</a>, but in the context of the time-dependence induced by the delta potential on an initial state, rather than through the application of the variational method to identify stationary states of this Hamiltonian.  We will choose an initial state to be the ground state of the ordinary particle in a box system, so again we will find it useful to build the Hamiltonian matrix in the basis of
the particle in a box states, and to express the wavefunction in terms of the amplitudes of each of these basis states.</p>
</section>
<section id="step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">
<h2>Step 0:  Import libraries and initialize a plot object for the animation<a class="headerlink" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span><span class="p">,</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>


<span class="c1"># First set up the figure, the axis, and the plot element we want to animate</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">### parameters for the box size and delta function</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>

<span class="c1">### grid of x values for the functions</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1">### parameters for plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Amp</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Amp</span><span class="p">))</span>

<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># initialization function: plot the background of each frame</span>
<span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">line</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="approach">
<h1>Approach<a class="headerlink" href="#approach" title="Permalink to this heading">#</a></h1>
<p>In general, the dynamics of a quantum system are determined by the time-dependent Schrodinger equation (TDSE),
$<span class="math notranslate nohighlight">\( i\hbar \frac{d}{dt}\Psi(x, t) = \hat{H} \Psi(x, t). \tag{1} \)</span>$</p>
<p>Just as <a class="reference external" href="https://escip.io/notebooks/linear_variational_method.html">before</a> can write the Hamiltonian operator for this system between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=10\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\hat{H} = -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + \delta(x-5).  \tag{2} \]</div>
<p>Also as before, we can build a matrix representation of this Hamiltonian <span class="math notranslate nohighlight">\( {\bf H}\)</span>  by introducing a basis.  We will use the
energy eigenfunctions of the ordinary particle in a box as this basis, where these basis functions are given by</p>
<div class="math notranslate nohighlight">
\[ \psi_n(x) = \sqrt{ \frac{2}{10} } {\rm sin}\left( \frac{n \pi x}{10} \right), \tag{3} \]</div>
<p>and the elements of <span class="math notranslate nohighlight">\( {\bf H}\)</span> will be given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-6cb25601-0a60-4af3-9271-1f3c1a02fb78">
<span class="eqno">(19)<a class="headerlink" href="#equation-6cb25601-0a60-4af3-9271-1f3c1a02fb78" title="Permalink to this equation">#</a></span>\[\begin{equation}
H_{nm} = \int_0^{10} \psi^*_n(x) \hat{H} \psi_m(x) dx. \tag{4} 
\end{equation}\]</div>
<p>Because the basis set comprised of all <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> is complete, we can represent our wavefunction at any instant in time as a linear combination of these basis functions:</p>
<div class="math notranslate nohighlight">
\[ \Psi(x, t) = \sum_n c_n(t) \psi_n(x) \tag{5} \]</div>
<p>where we are denoting that the basis functions are time-independent, and the time-dependence is contained only in
the expansion coefficients <span class="math notranslate nohighlight">\(c_n(t)\)</span>.  Thus we can map the time-dependence of the collection of these coefficients, which we will call <span class="math notranslate nohighlight">\({\bf c}(t)\)</span> to the time-dependence of the wavefunction.<br />
This suggests that the TDSE can be recast as
$<span class="math notranslate nohighlight">\( i\hbar \frac{d}{dt} {\bf c}(t) = {\bf H} {\bf c}(t). \tag{6} \)</span>$</p>
<section id="numerically-solving-the-tdse-part-1-euler-method">
<h2>Numerically Solving the TDSE Part 1:  Euler Method<a class="headerlink" href="#numerically-solving-the-tdse-part-1-euler-method" title="Permalink to this heading">#</a></h2>
<p>The key idea for numerically solving the TDSE is that if we know the coefficients at one instant in time,
<span class="math notranslate nohighlight">\({\bf c}(t_0)\)</span> and wish to find the coefficients at a later time <span class="math notranslate nohighlight">\(t_0 + \Delta t\)</span>, we can approximate
<span class="math notranslate nohighlight">\({\bf c}(t_0 + \Delta t)\)</span> using information about the time derivative of the coefficients given by the TDSE.  The simplest approximation is known as the Euler update, and has the form</p>
<div class="math notranslate nohighlight">
\[ {\bf c}(t_0 + \Delta t) = {\bf c}(t_0) + \frac{d}{dt} {\bf c}(t_0) \Delta t, \tag{7} \]</div>
<p>where from the TDSE, we can see</p>
<div class="math notranslate nohighlight">
\[ \frac{d}{dt} {\bf c}(t_0) = -\frac{i}{\hbar} {\bf H} {\bf c}(t_0). \tag{8} \]</div>
</section>
<section id="numerically-solving-the-tdse-part-2-runge-kutta-method">
<h2>Numerically Solving the TDSE Part 2:  Runge-Kutta Method<a class="headerlink" href="#numerically-solving-the-tdse-part-2-runge-kutta-method" title="Permalink to this heading">#</a></h2>
<p>A more numerically stable approach for updating the wavefunction can be obtained by applying the 4<span class="math notranslate nohighlight">\(^{\rm th}\)</span>-order
Runge-Kutta Method.  In this approach, we approximate the <span class="math notranslate nohighlight">\({\bf c}\)</span> vector at a future time in the following way:</p>
<div class="math notranslate nohighlight">
\[ {\bf c}(t_0 + \Delta t) = {\bf c}(t_0) + \frac{1}{6}\left(k_1 + 2k_2 + 2k_3 + k_4 \right)\Delta t \tag{9} \]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight" id="equation-5858e771-d89c-40fb-9446-e1e090fa55f1">
<span class="eqno">(20)<a class="headerlink" href="#equation-5858e771-d89c-40fb-9446-e1e090fa55f1" title="Permalink to this equation">#</a></span>\[\begin{align}
k_1 &amp;= -\frac{i}{\hbar} {\bf H}(t_0) {\bf c}(t_0) \\
k_2 &amp;= -\frac{i}{\hbar} {\bf H}\left(t_0 + \frac{\Delta t}{2}\right) \left( {\bf c}(t_0) + k_1 \frac{\Delta t}{2} \right) \\ \tag{10}
k_3 &amp;= -\frac{i}{\hbar} {\bf H}\left(t_0 + \frac{\Delta t}{2}\right) \left( {\bf c}(t_0) + k_2 \frac{\Delta t}{2} \right) \\
k_4 &amp;= -\frac{i}{\hbar} {\bf H}\left(t_0 + \Delta t\right) \left( {\bf c}(t_0) + k_3 \Delta t \right). \\
\end{align}\]</div>
<p>If the Hamiltonian does not depend upon time, as is the case for the particle in a box with a delta potential, then <span class="math notranslate nohighlight">\({\bf H} = {\bf H}(t_0) = {\bf H}\left(t_0 + \frac{\Delta t}{2}\right) = {\bf H}\left(t_0 + \Delta t\right)\)</span>.</p>
<p>Each <span class="math notranslate nohighlight">\(k_n\)</span> term can be seen as a particular time derivative that results from the action of the Hamiltonian on an
estimate of the <span class="math notranslate nohighlight">\({\bf c}\)</span> vector at some instant in time.  We can see that the <span class="math notranslate nohighlight">\(k_1\)</span> is exactly equal to Eq. (8),
that is it results from the action of <span class="math notranslate nohighlight">\({\bf H}\)</span> on <span class="math notranslate nohighlight">\({\bf c}\)</span> at the current instant in time <span class="math notranslate nohighlight">\(t_0\)</span>.<br />
In the case that <span class="math notranslate nohighlight">\({\bf H}\)</span> is time-independent, then <span class="math notranslate nohighlight">\(k_2\)</span> is simply defined as the action of <span class="math notranslate nohighlight">\({\bf H}\)</span> on a
<span class="math notranslate nohighlight">\({\bf c}\)</span> vector that has been updated by half an Euler step, i.e. equivalent to Eq. (7) with an update of <span class="math notranslate nohighlight">\(\frac{\Delta t}{2}\)</span>.  More can be read about the Runge-Kutta method <a class="reference external" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">here</a>.</p>
</section>
<section id="questions-part-1">
<h2>Questions Part 1:<a class="headerlink" href="#questions-part-1" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>We will include the helper functions from before that will build the Hamiltonian matrix in the PIB basis. Add a function called <code class="docutils literal notranslate"><span class="pre">compute_c_dot(H,</span> <span class="pre">c)</span></code> that will take the Hamiltonian matrix and a given c vector and return the time-derivative of the c vector using the TDSE using Eq. (8).</p></li>
<li><p>Write a function called <code class="docutils literal notranslate"><span class="pre">euler_update(H,</span> <span class="pre">c,</span> <span class="pre">dt)</span></code> that takes the Hamiltonian matrix <code class="docutils literal notranslate"><span class="pre">H</span></code>, a c vector <code class="docutils literal notranslate"><span class="pre">c</span></code> and a time increment <code class="docutils literal notranslate"><span class="pre">dt</span></code> and returns the c vector at a future time using Eq. (7).  It can call <code class="docutils literal notranslate"><span class="pre">compute_c_dot(H,</span> <span class="pre">c)</span></code> to get the time-derivative of <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p></li>
<li><p>Write a function called <code class="docutils literal notranslate"><span class="pre">rk4_update(H,</span> <span class="pre">c,</span> <span class="pre">dt)</span></code> that takes <code class="docutils literal notranslate"><span class="pre">H</span></code>, a c vector <code class="docutils literal notranslate"><span class="pre">c</span></code> and a time increment <code class="docutils literal notranslate"><span class="pre">dt</span></code> and returns the c vector at a future time using Eq. (9).</p></li>
<li><p>If we use only the kinetic energy matrix, then we know analytically time-dependence of any arbitrary state is given by <span class="math notranslate nohighlight">\(\Psi(x,t) = \sum_n c_n(t_0){\rm e}^{-iE_n t/\hbar} \psi_n(x) {\rm e}^{-iE_n t/\hbar}\)</span>.  Write a test to confirm that evolving the initial state <span class="math notranslate nohighlight">\({\bf c}(t_0) = (1, 0, ..., 0)\)</span> to <span class="math notranslate nohighlight">\({\bf c}(0.1)\)</span> using <code class="docutils literal notranslate"><span class="pre">rk4_update()</span></code> with the kinetic energy matrix matches the analytical result.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">energy_eigenvalue</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box, the length </span>
<span class="sd">        of the box L, and the mass of the particle m and return the energy eigenvalue in atomic units.</span>
<span class="sd">        Both the length and mass should be in atomic units.</span>
<span class="sd">        </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the particle in a box</span>
<span class="sd">        </span>
<span class="sd">    L : float</span>
<span class="sd">        the length of the box in atomic units</span>
<span class="sd">    m : float</span>
<span class="sd">        the mass of the particle in atomic units</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="k">return</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">L</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">energy_eigenfunction</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box, the length </span>
<span class="sd">        of the box L, and x-coordinate value(s) (single value or list) and return the corresponding</span>
<span class="sd">        energy eigenstate value(s) of the ordinary particle in a box</span>
<span class="sd">        </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the particle in a box      </span>
<span class="sd">    L : float</span>
<span class="sd">        the length of the box in atomic units</span>
<span class="sd">    x : float (or numpy array of floats)</span>
<span class="sd">        the position variable for the energy eigenstate in atomic units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Hamiltonian_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take two indices (n, m) and return the Hamiltonian matrix element H_{n,m}, </span>
<span class="sd">        which is &lt;n|H|m&gt; in Dirac&#39;s Bra-Ket notation.  This will call Kinetic_matrix_element(n, m) and</span>
<span class="sd">        Potential_matrix_element(n, m).</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H_mn : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|H|m&gt; = &lt;n|T|m&gt; + &lt;n|V|m&gt;</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; H_12 = Hamiltonian_matrix_element(1,2)</span>
<span class="sd">    &gt;&gt;&gt; H_33 = Hamiltonian_matrix_element(3,3)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    if n == m, you need to include kinetic and potential contributions of &lt;n|H|n&gt;.</span>
<span class="sd">    e.g. &lt;n|H|n&gt; = &lt;n|T|n&gt; + &lt;n|V|n&gt; = &lt;n|E_n|n&gt; + &lt;n|V|n&gt; = E_n&lt;n|n&gt; + &lt;n|V|n&gt; = E_n + &lt;n|V|n&gt;</span>
<span class="sd">    where E_n is the energy eigenvalue of the ordinary particle in a box state \psi_n(x)</span>
<span class="sd">    </span>
<span class="sd">    if n != m, you need to include only the potential contribution &lt;n|V|m&gt;.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">H_nm</span> <span class="o">=</span> <span class="n">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H_nm</span>

<span class="k">def</span> <span class="nf">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function to take two indices (n, m) and return the Kinetic Energy matrix element T_{n,m}, </span>
<span class="sd">        which is &lt;n|T|m&gt; in Dirac&#39;s Bra-Ket notation.  </span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T_nm : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|T|m&gt; = E_m &lt;n|m&gt;</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; T_12 = Kinetic_matrix_element(1,2) -&gt; 0</span>
<span class="sd">    &gt;&gt;&gt; T_33 = Kinetic_matrix_element(3,3) -&gt; E_3</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T_nm</span> <span class="o">=</span> <span class="n">energy_eigenvalue</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">T_nm</span>

<span class="k">def</span> <span class="nf">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function to take two indices (n, m) and return the Hamiltonian matrix element V_{n,m}, </span>
<span class="sd">        which is &lt;n|V|m&gt; in Dirac&#39;s Bra-Ket notation and V = \delta(x-5)</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    V_nm : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|V|m&gt; = \psi_n(5) * psi_m(5)</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; V_12 = Potential_matrix_element(1,2)</span>
<span class="sd">    &gt;&gt;&gt; V_33 = Potential_matrix_element(3,3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">V_nm</span> <span class="o">=</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">V_nm</span>

<span class="k">def</span> <span class="nf">build_matrices</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function that will build and return the Hamiltonian, Kinetic, and Potential energy matrices</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n_basis : int</span>
<span class="sd">        the number of basis functions used to build the matrices</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : n_basis x n_basis array of floats</span>
<span class="sd">         the total Hamiltonian matrix</span>
<span class="sd">         </span>
<span class="sd">    T : n_basis x n_basis array of floats</span>
<span class="sd">         the kinetic energy matrix</span>
<span class="sd">         </span>
<span class="sd">    V : n_basis x n_basis array of floats</span>
<span class="sd">         the potential energy matrix </span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; H, T, V = build_matrices(3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># i starts from 0 but n should start at 1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># j starts at 0 but m should start at 1</span>
            <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hamiltonian_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span>

<span class="k">def</span> <span class="nf">compute_c_dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function that will compute d/dt c(t_0) using -i/hbar H * c </span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    H : n_basis x n_basis numpy array of floats</span>
<span class="sd">        the Hamiltonian matrix in atomic units</span>
<span class="sd">        </span>
<span class="sd">    c : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of coefficients that defines the time-dependent wavefunction</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c_dot : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of time-derivatives of the coefficients</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># &lt;== define imaginary unit as ci = 0+1j</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># &lt;== compute matrix-vector product of H and c to get c_dot</span>
    <span class="n">c_dot</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ci</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c_dot</span>

<span class="k">def</span> <span class="nf">euler_update</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function that will take c(t0) and H and return c(t0 + dt)</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    H : n_basis x n_basis numpy array of floats</span>
<span class="sd">        the Hamiltonian matrix in atomic units</span>
<span class="sd">        </span>
<span class="sd">    c : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of coefficients that defines the time-dependent wavefunction</span>
<span class="sd">        </span>
<span class="sd">    dt : float</span>
<span class="sd">        the increment in time in atomic units</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c_new : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of coefficients at time t0 + dt</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># &lt;== call compute_c_dot(H, c) to compute c_dot</span>
    <span class="n">c_dot</span> <span class="o">=</span> <span class="n">compute_c_dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="c1"># &lt;== compute c_new using c, c_dot, and dt</span>
    <span class="n">c_new</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c_dot</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="k">return</span> <span class="n">c_new</span>

<span class="k">def</span> <span class="nf">rk4_update</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function that will take c(t0) and H and return c(t0 + dt)</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    H : n_basis x n_basis numpy array of floats</span>
<span class="sd">        the Hamiltonian matrix in atomic units</span>
<span class="sd">        </span>
<span class="sd">    c : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of coefficients that defines the time-dependent wavefunction</span>
<span class="sd">        </span>
<span class="sd">    dt : float</span>
<span class="sd">        the increment in time in atomic units</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c_new : 1 x n_basis numpy array of complex floats</span>
<span class="sd">        the vector of coefficients at time t0 + dt</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># &lt;== define k_1, k_2, k_3, k_4</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span>
    <span class="n">k_1</span> <span class="o">=</span> <span class="o">-</span><span class="n">ci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> 
    <span class="n">k_2</span> <span class="o">=</span> <span class="o">-</span><span class="n">ci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">k_1</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">k_3</span> <span class="o">=</span> <span class="o">-</span><span class="n">ci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">k_2</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">k_4</span> <span class="o">=</span> <span class="o">-</span><span class="n">ci</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">k_3</span> <span class="o">*</span> <span class="n">dt</span><span class="p">))</span>
    <span class="c1"># &lt;== define c_new as 1/6 * (k_1 + 2 * k_2 + 2 * k_3 + k_4) * dt</span>
    <span class="n">c_new</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k_1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k_2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k_3</span> <span class="o">+</span> <span class="n">k_4</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="k">return</span> <span class="n">c_new</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="test-for-rk4-update-function">
<h1>Test for rk4_update function<a class="headerlink" href="#test-for-rk4-update-function" title="Permalink to this heading">#</a></h1>
<p>Assume initial condition <span class="math notranslate nohighlight">\(\Psi(x,t_0) = \psi_1(x)e^{-iE_1 t_0/\hbar}\)</span> and <span class="math notranslate nohighlight">\(t_0 = 0\)</span>
and update using RK4 to <span class="math notranslate nohighlight">\(t_f = 1\)</span> atomic units with a time-step of <span class="math notranslate nohighlight">\(\Delta t = 0.01\)</span>.  We will
feed the kinetic energy matrix to the RK4 method so that the time evolution should correspond give us
<span class="math notranslate nohighlight">\(\Psi(x,t_f) = \psi_1(x)e^{-iE_1 t_f/\hbar}\)</span> and <span class="math notranslate nohighlight">\(t_f = 1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imaginary unit</span>
<span class="n">ci</span> <span class="o">=</span> <span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span>

<span class="c1"># E1 </span>
<span class="n">E1</span> <span class="o">=</span> <span class="n">energy_eigenvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># dt</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c1"># tf</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># define initial c vector for RK4 update</span>
<span class="n">c_rk4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

<span class="c1"># number of basis functions</span>
<span class="n">n_basis</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># build H, T, and V</span>
<span class="n">Hamiltonian_matrix</span><span class="p">,</span> <span class="n">Kinetic_matrix</span><span class="p">,</span> <span class="n">Potential_matrix</span> <span class="o">=</span> <span class="n">build_matrices</span><span class="p">(</span><span class="n">n_basis</span><span class="p">)</span>

<span class="c1"># Define analytical result for c(t_f)</span>
<span class="n">c_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ci</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">*</span> <span class="n">tf</span>  <span class="p">),</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># update c_rk4 100 times using the RK4 method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
    <span class="n">c_rk4</span> <span class="o">=</span> <span class="n">rk4_update</span><span class="p">(</span><span class="n">Kinetic_matrix</span><span class="p">,</span> <span class="n">c_rk4</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>


<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">c_analytical</span><span class="p">,</span> <span class="n">c_rk4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PASSED!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PASSED!
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="time-dependence-with-the-delta-potential">
<h1>Time-dependence with the delta potential<a class="headerlink" href="#time-dependence-with-the-delta-potential" title="Permalink to this heading">#</a></h1>
<p>Now we will propage the same initial state using the full Hamiltonian including the delta potential.  We will use a larger basis this time to capture the dynamics imparted by the potential.
The following lines will build the Hamiltonian matrix, define an initial c-vector, and update it using the RK4 method for a number of time-steps storing the time-dependent c-vector in a n_basis x n_time numpy array of complex floats</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of basis functions</span>
<span class="n">n_basis</span> <span class="o">=</span> <span class="mi">70</span>

<span class="c1"># build H, T, and V</span>
<span class="n">Hamiltonian_matrix</span><span class="p">,</span> <span class="n">Kinetic_matrix</span><span class="p">,</span> <span class="n">Potential_matrix</span> <span class="o">=</span> <span class="n">build_matrices</span><span class="p">(</span><span class="n">n_basis</span><span class="p">)</span>

<span class="c1"># number of time steps</span>
<span class="n">N_time</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># create the c_vec array as a n_basis x N_time numpy array of complex floats</span>
<span class="n">c_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">N_time</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

<span class="c1"># define a time increment of 0.005 atomic units</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c1"># initialize the c(0) vector as (1+0j, 0, 0, ...) -&gt; initial state = \psi_1(x)</span>
<span class="n">c_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

<span class="c1"># loop over time-steps and update the c-vector at each time</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_time</span><span class="p">):</span>
    <span class="n">c_vec</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rk4_update</span><span class="p">(</span><span class="n">Hamiltonian_matrix</span><span class="p">,</span> <span class="n">c_vec</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following lines will animate the wavefunction as shown in Eq. (5).  Now, the elements of <span class="math notranslate nohighlight">\({\bf c}(t)\)</span> are stored
in <code class="docutils literal notranslate"><span class="pre">c_vec</span></code>, and the <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> functions can be obtained by calling <code class="docutils literal notranslate"><span class="pre">energy_eigenfunction(n,</span> <span class="pre">L,</span> <span class="pre">x)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_time</span><span class="p">)</span>


<span class="c1"># animation function. This is called sequentially  </span>
<span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">):</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">c_vec</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fx</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">line</span><span class="p">,)</span>
  

<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
                             <span class="n">frames</span><span class="o">=</span><span class="n">N_time</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Note: below is the part which makes it work on Colab</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="s1">&#39;jshtml&#39;</span><span class="p">)</span>
<span class="n">anim</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ESCIP/escip.github.io",
            ref: "jbook",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="gaussian_wavepacket.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Time evolution of a Gaussian wavepacket</p>
      </div>
    </a>
    <a class="right-next"
       href="modelfit_part1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fitting Models to Data (Part 1)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Dynamics of particle in a box with a delta potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-0-import-libraries-and-initialize-a-plot-object-for-the-animation">Step 0:  Import libraries and initialize a plot object for the animation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerically-solving-the-tdse-part-1-euler-method">Numerically Solving the TDSE Part 1:  Euler Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerically-solving-the-tdse-part-2-runge-kutta-method">Numerically Solving the TDSE Part 2:  Runge-Kutta Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-part-1">Questions Part 1:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-rk4-update-function">Test for rk4_update function</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependence-with-the-delta-potential">Time-dependence with the delta potential</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ESCIP Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>