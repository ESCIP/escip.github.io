
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linear Variational Method &#8212; ESCIP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time evolution of a Gaussian wavepacket" href="gaussian_wavepacket.html" />
    <link rel="prev" title="Fourier Transforms" href="fourier_transform.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESCIP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../team.html">
   Team
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../guidelines/intro.html">
   Guidelines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../guidelines/guidelines.html">
     Format of notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guidelines/template.html">
     Template notebook
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../workshops/intro.html">
   Workshops
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../workshops/workshop2023.html">
     January 2023 In-Person Workshop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../workshops/workshop2022.html">
     Summer 2022 In-Person Workshop
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fourier_transform.html">
   Fourier Transforms
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Linear Variational Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gaussian_wavepacket.html">
   Time evolution of a Gaussian wavepacket
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pib_delta_potential_dynamics.html">
   Dyanmics of particle in a box with a delta potential
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modelfit_part1.html">
   Fitting Models to Data (Part 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modelfit_part2.html">
   Fitting Models to Data (Part 2)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sdss_tutorial_1.html">
   SDSS Tutorial #1:  Data Querying and Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="star_formation_v2.html">
   Star Formation in Galaxies
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ESCIP/escip.github.io/jbook?urlpath=lab/tree/notebooks/linear_variational_method.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ESCIP/escip.github.io/blob/jbook/notebooks/linear_variational_method.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ESCIP/escip.github.io"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ESCIP/escip.github.io/issues/new?title=Issue%20on%20page%20%2Fnotebooks/linear_variational_method.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/linear_variational_method.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Linear Variational Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-outcomes">
     Learning Outcomes
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#approach">
   Approach
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#form-of-the-trial-wavefunction">
     Form of the trial wavefunction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#form-of-the-energy-functional-of-the-trial-wavefunction">
     Form of the energy functional of the trial wavefunction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-units">
     Atomic Units
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-the-linear-variational-problem">
     Solving the Linear Variational Problem
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions-part-1">
     Questions Part 1:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variational-optimization">
       Variational optimization
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-the-variational-ground-state">
       Visualizing the variational ground-state
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions-part-2">
     Questions Part 2:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#behavior-of-total-energy-kinetic-energy-and-potential-energy-functionals-with-basis-set-size">
     Behavior of Total Energy, Kinetic Energy, and Potential Energy functionals with basis set size.
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Linear Variational Method</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Linear Variational Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-outcomes">
     Learning Outcomes
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#approach">
   Approach
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#form-of-the-trial-wavefunction">
     Form of the trial wavefunction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#form-of-the-energy-functional-of-the-trial-wavefunction">
     Form of the energy functional of the trial wavefunction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-units">
     Atomic Units
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-the-linear-variational-problem">
     Solving the Linear Variational Problem
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions-part-1">
     Questions Part 1:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variational-optimization">
       Variational optimization
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-the-variational-ground-state">
       Visualizing the variational ground-state
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions-part-2">
     Questions Part 2:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#behavior-of-total-energy-kinetic-energy-and-potential-energy-functionals-with-basis-set-size">
     Behavior of Total Energy, Kinetic Energy, and Potential Energy functionals with basis set size.
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="linear-variational-method">
<h1>Linear Variational Method<a class="headerlink" href="#linear-variational-method" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://foleylab.github.io/">Prof. Jay Foley, University of North Carolina Charlotte</a></p>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>To demonstrate the use of the Linear Variational Method to the model system of the particle in a box with a delta potential</p></li>
<li><p>To illustrate the impact of basis set size on the variational energy</p></li>
</ul>
</section>
<section id="learning-outcomes">
<h2>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">#</a></h2>
<p>By the end of this workbook, students should be able to</p>
<ul class="simple">
<li><p>Implement expressions for Hamiltonian matrix elements of the particle in a box with a delta function potential into simple python code</p></li>
<li><p>Express a linear expansion of basis functions as a numpy array</p></li>
<li><p>Utilize numpy’s matrix-vector operations to compute energy expectation values of different trial wavefunctions</p></li>
<li><p>Utilize numpy’s <code class="docutils literal notranslate"><span class="pre">linalg.eigh</span></code> function to obtain eigenvalues and eigenvectors of a Hamiltonian matrix</p></li>
<li><p>Plot the variational ground-state wavefunction using <code class="docutils literal notranslate"><span class="pre">pyplot</span></code></p></li>
</ul>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>We will apply the Linear Variational Method to the particle in a box of length <span class="math notranslate nohighlight">\(10\)</span> atomic units
with a delta function potential centered at <span class="math notranslate nohighlight">\(x=5\)</span> atomic units. We will plot the delta function potential and the infinite potential walls at <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(x = 10\)</span>
in the next cell using the python library <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and the special function from the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> library called
<code class="docutils literal notranslate"><span class="pre">signal.unit_impulse</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># create an array of x-values between 0 and 10</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># create the delta function potential.  Need to specify that it will be in the middle </span>
<span class="c1"># of 500 samples along x.  We will scale this by the amplitude of the normalized energy </span>
<span class="c1"># eigenstates so that this potential appears on the same scale as the eigenfunctions</span>
<span class="n">V_x</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">unit_impulse</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="o">/</span><span class="mi">10</span>
<span class="n">V_0</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">unit_impulse</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">V_L</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">unit_impulse</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">499</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">V_x</span> <span class="o">+</span> <span class="n">V_0</span> <span class="o">+</span> <span class="n">V_L</span>

<span class="c1"># now plot V_x against x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Position (atomic units)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Potential (atomic units)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear_variational_method_1_0.png" src="../_images/linear_variational_method_1_0.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="approach">
<h1>Approach<a class="headerlink" href="#approach" title="Permalink to this headline">#</a></h1>
<p>We can write the Hamiltonian for this system between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=10\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\hat{H} = -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + \delta(x-5), \]</div>
<p>and we notice that this looks very similar to the Hamiltonian we know from the ordinary particle in a box
except for the presence of this peculiar spikey potential right in the middle of the box.  We could try to find <a class="reference external" href="https://arxiv.org/pdf/1001.0311.pdf">the exact eigenfunctions for this Hamiltonian</a>, but we can also obtain insights and reasonably good results utilizing approximate methods, such as the <a class="reference external" href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Supplemental_Modules_(Physical_and_Theoretical_Chemistry)/Quantum_Mechanics/17%3A_Quantum_Calculations/Variational_Method#:~:text=The%20Variational%20Method%20is%20a,the%20known%20and%20approximated%20energies">Variational Method</a> or <a class="reference external" href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Book%3A_Quantum_States_of_Atoms_and_Molecules_(Zielinksi_et_al)/09%3A_The_Electronic_States_of_the_Multielectron_Atoms/9.03%3A_Perturbation_Theory">Perturbation Theory</a>.  Here we will use the Variational Method.</p>
<section id="form-of-the-trial-wavefunction">
<h2>Form of the trial wavefunction<a class="headerlink" href="#form-of-the-trial-wavefunction" title="Permalink to this headline">#</a></h2>
<p>In particular, we will optimize the trial wavefunction given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-0817913f-8c70-4db4-be2e-98bbde76e7a9">
<span class="eqno">(1)<a class="headerlink" href="#equation-0817913f-8c70-4db4-be2e-98bbde76e7a9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Phi(x) = \sum_{n=1}^N c_n \psi_n(x)
\end{equation}\]</div>
<p>where the expansion coefficients <span class="math notranslate nohighlight">\(c_n\)</span> are real numbers
and <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> are the energy eigenfunctions of the ordinary particle in a box that has no potential
between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L\)</span>.  In particular, these eigenfunctions have the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-3bfad0da-ed7d-41bd-8e0a-232d5c30b892">
<span class="eqno">(2)<a class="headerlink" href="#equation-3bfad0da-ed7d-41bd-8e0a-232d5c30b892" title="Permalink to this equation">#</a></span>\[\begin{equation}
\psi_n(x) = \sqrt{\frac{2}{10} } {\rm sin}\left(\frac{n \pi x}{10} \right).
\end{equation}\]</div>
</section>
<section id="form-of-the-energy-functional-of-the-trial-wavefunction">
<h2>Form of the energy functional of the trial wavefunction<a class="headerlink" href="#form-of-the-energy-functional-of-the-trial-wavefunction" title="Permalink to this headline">#</a></h2>
<p>We will seek to minimize the energy functional of the trial wavefunction through the expansion coefficients, where the
energy functional of the trial wavefunction can be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-edf0ea7e-6608-44ba-b870-b69290af1337">
<span class="eqno">(3)<a class="headerlink" href="#equation-edf0ea7e-6608-44ba-b870-b69290af1337" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_{trial} = \frac{\int_0^{10} \Phi^* (x) \: \hat{H} \: \Phi(x) dx }{\int_0^{10} \Phi^* (x) \: \Phi(x) dx },
\end{equation}\]</div>
<p>where we have recognized that the boundaries of the box are at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=10\)</span>, so our range of integration
goes between these boundaries.</p>
</section>
<section id="atomic-units">
<h2>Atomic Units<a class="headerlink" href="#atomic-units" title="Permalink to this headline">#</a></h2>
<p>We will express our Hamiltonian in atomic units where <span class="math notranslate nohighlight">\(\hbar = 1\)</span> and <span class="math notranslate nohighlight">\(m = 1\)</span>, so we can write the Hamiltonian in
this unit system as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f7ef77f9-041f-4058-9618-579d89876ff6">
<span class="eqno">(4)<a class="headerlink" href="#equation-f7ef77f9-041f-4058-9618-579d89876ff6" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat{H} = -\frac{1}{2} \frac{d^2}{dx^2} + \delta(x-5).
\end{equation}\]</div>
<p>We further note that the Hamiltonian can be written as a sum
of kinetic and potential operators, <span class="math notranslate nohighlight">\(\hat{H} = \hat{T} + \hat{V}\)</span>
where <span class="math notranslate nohighlight">\(\hat{T} = -\frac{1}{2} \frac{d^2}{dx^2}\)</span> and <span class="math notranslate nohighlight">\(\hat{V} = \delta(x-5)\)</span>.  For the ordinary particle in a box, the Hamiltonian only contains <span class="math notranslate nohighlight">\(\hat{T}\)</span>, so we can note that the particle in a box energy eigenfunctions obey the following eigenvalue equation with the kinetic energy operator (in atomic units)</p>
<div class="amsmath math notranslate nohighlight" id="equation-ea55f530-fd0f-4148-bfd8-67f318b9b61e">
<span class="eqno">(5)<a class="headerlink" href="#equation-ea55f530-fd0f-4148-bfd8-67f318b9b61e" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat{T} \psi_n(x) = \frac{\pi^2 n^2}{200} \psi_n(x) \equiv E_n \psi_n(x).   
\end{equation}\]</div>
</section>
<section id="solving-the-linear-variational-problem">
<h2>Solving the Linear Variational Problem<a class="headerlink" href="#solving-the-linear-variational-problem" title="Permalink to this headline">#</a></h2>
<p>The Linear Variational Method is carried out by minimizing <span class="math notranslate nohighlight">\(E_{trial}\)</span> with respect to the expansion coefficients in <span class="math notranslate nohighlight">\(\Phi(x)\)</span>.  This leads
to the condition that the partial derivative of the trial energy with
respect to each expansion coefficient is zero:</p>
<div class="amsmath math notranslate nohighlight" id="equation-44b4cf8c-9060-4a49-9ef5-59ae6f092acc">
<span class="eqno">(6)<a class="headerlink" href="#equation-44b4cf8c-9060-4a49-9ef5-59ae6f092acc" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\partial}{\partial c_m} E_{trial} = 0 \; \; \forall \; m.
\end{equation}\]</div>
<p>When this is true, the trial energy and the expansion
coefficients satisfy the following equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c95863a4-e7fc-408c-90c5-aa19a26bff2b">
<span class="eqno">(7)<a class="headerlink" href="#equation-c95863a4-e7fc-408c-90c5-aa19a26bff2b" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_{trial} c_m = \sum_{n=1}^N H_{nm} c_n,
\end{equation}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight" id="equation-40d1b167-35f6-43aa-902d-82d95c05417c">
<span class="eqno">(8)<a class="headerlink" href="#equation-40d1b167-35f6-43aa-902d-82d95c05417c" title="Permalink to this equation">#</a></span>\[\begin{equation}
H_{nm} = \int_0^{10} \psi^*_n(x) \hat{H} \psi_m(x) dx. 
\end{equation}\]</div>
<p>This can be written as an eigenvalue equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-ea24bd48-fe90-4836-ab53-f2214d1f7097">
<span class="eqno">(9)<a class="headerlink" href="#equation-ea24bd48-fe90-4836-ab53-f2214d1f7097" title="Permalink to this equation">#</a></span>\[\begin{equation}
{\bf H} {\bf c} = E_{trial} {\bf c},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\({\bf H}\)</span> is the matrix whose elements are given by <span class="math notranslate nohighlight">\(H_{nm}\)</span> and <span class="math notranslate nohighlight">\({\bf c}\)</span> is the vector of coefficients.</p>
</section>
<section id="questions-part-1">
<h2>Questions Part 1:<a class="headerlink" href="#questions-part-1" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>The matrix element <span class="math notranslate nohighlight">\(H_{nm}\)</span> can be expressed as a sum of kinetic and potential matrix elements, <span class="math notranslate nohighlight">\(T_{nm} + V_{nm}\)</span> where</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-4d635e8b-c971-445a-a554-47a80b50e674">
<span class="eqno">(10)<a class="headerlink" href="#equation-4d635e8b-c971-445a-a554-47a80b50e674" title="Permalink to this equation">#</a></span>\[\begin{equation}
T_{nm} = \int_0^{10} \psi^*_n(x) \hat{T} \psi_m(x) dx 
\end{equation}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-4e5b882d-e051-49d8-8c85-f41fcdfe4427">
<span class="eqno">(11)<a class="headerlink" href="#equation-4e5b882d-e051-49d8-8c85-f41fcdfe4427" title="Permalink to this equation">#</a></span>\[\begin{equation}
V_{nm} = \int_0^{10} \psi^*_n(x) \hat{V} \psi_m(x) dx. 
\end{equation}\]</div>
<p>Write a general expression for the elements of <span class="math notranslate nohighlight">\(T_{nm}\)</span> and <span class="math notranslate nohighlight">\(V_{nm}\)</span>
for our particle in a box with a delta potential.</p>
<ol class="simple">
<li><p>Write two python functions <code class="docutils literal notranslate"><span class="pre">Kinetic_matrix_element(n,</span> <span class="pre">m)</span></code>, <code class="docutils literal notranslate"><span class="pre">Potential_matrix_element(n,</span> <span class="pre">m)</span></code> that take the indices <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> and return the corresponding value of <span class="math notranslate nohighlight">\(T_{nm}\)</span> and <span class="math notranslate nohighlight">\(V_{nm}\)</span>.  Skeleton code for this function follows.  Three helper functions are provided:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">energy_eigenvalue(n,</span> <span class="pre">L,</span> <span class="pre">m)</span></code> that can provide the energy eigenvalues of the ordinary particle in a box for energy eigenstate <span class="math notranslate nohighlight">\(n\)</span>, length <span class="math notranslate nohighlight">\(L\)</span>, and mass <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">energy_eigenfunction(n,</span> <span class="pre">L,</span> <span class="pre">x)</span></code> that can provide the value(s) of the energy eigenfunction of the ordinary particle in a box for energy eigenstate <span class="math notranslate nohighlight">\(n\)</span> with length <span class="math notranslate nohighlight">\(L\)</span> evaluated at x-value(s) <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">Hamiltonian_matrix_element(n,</span> <span class="pre">m)</span></code> that will call the <code class="docutils literal notranslate"><span class="pre">Kinetic_matrix_element</span></code> and <code class="docutils literal notranslate"><span class="pre">Potential_matrix_element</span></code> functions to return the total Hamiltonian matrix element value.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">energy_eigenvalue</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box, the length </span>
<span class="sd">        of the box L, and the mass of the particle m and return the energy eigenvalue in atomic units.</span>
<span class="sd">        Both the length and mass should be in atomic units.</span>
<span class="sd">        </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the particle in a box</span>
<span class="sd">        </span>
<span class="sd">    L : float</span>
<span class="sd">        the length of the box in atomic units</span>
<span class="sd">    m : float</span>
<span class="sd">        the mass of the particle in atomic units</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="k">return</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">L</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">energy_eigenfunction</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take the quantum number n of the particle in a box, the length </span>
<span class="sd">        of the box L, and x-coordinate value(s) (single value or list) and return the corresponding</span>
<span class="sd">        energy eigenstate value(s) of the ordinary particle in a box</span>
<span class="sd">        </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the particle in a box      </span>
<span class="sd">    L : float</span>
<span class="sd">        the length of the box in atomic units</span>
<span class="sd">    x : float (or numpy array of floats)</span>
<span class="sd">        the position variable for the energy eigenstate in atomic units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Hamiltonian_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take two indices (n, m) and return the Hamiltonian matrix element H_{n,m}, </span>
<span class="sd">        which is &lt;n|H|m&gt; in Dirac&#39;s Bra-Ket notation.  This will call Kinetic_matrix_element(n, m) and</span>
<span class="sd">        Potential_matrix_element(n, m).</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H_mn : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|H|m&gt; = &lt;n|T|m&gt; + &lt;n|V|m&gt;</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; H_12 = Hamiltonian_matrix_element(1,2)</span>
<span class="sd">    &gt;&gt;&gt; H_33 = Hamiltonian_matrix_element(3,3)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    if n == m, you need to include kinetic and potential contributions of &lt;n|H|n&gt;.</span>
<span class="sd">    e.g. &lt;n|H|n&gt; = &lt;n|T|n&gt; + &lt;n|V|n&gt; = &lt;n|E_n|n&gt; + &lt;n|V|n&gt; = E_n&lt;n|n&gt; + &lt;n|V|n&gt; = E_n + &lt;n|V|n&gt;</span>
<span class="sd">    where E_n is the energy eigenvalue of the ordinary particle in a box state \psi_n(x)</span>
<span class="sd">    </span>
<span class="sd">    if n != m, you need to include only the potential contribution &lt;n|V|m&gt;.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">H_nm</span> <span class="o">=</span> <span class="n">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H_nm</span>

<span class="k">def</span> <span class="nf">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function to take two indices (n, m) and return the Kinetic Energy matrix element T_{n,m}, </span>
<span class="sd">        which is &lt;n|T|m&gt; in Dirac&#39;s Bra-Ket notation.  </span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T_nm : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|T|m&gt; = E_m &lt;n|m&gt;</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; T_12 = Kinetic_matrix_element(1,2) -&gt; 0</span>
<span class="sd">    &gt;&gt;&gt; T_33 = Kinetic_matrix_element(3,3) -&gt; E_3</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T_nm</span> <span class="o">=</span> <span class="n">energy_eigenvalue</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">T_nm</span>

<span class="k">def</span> <span class="nf">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function to take two indices (n, m) and return the Hamiltonian matrix element V_{n,m}, </span>
<span class="sd">        which is &lt;n|V|m&gt; in Dirac&#39;s Bra-Ket notation and V = \delta(x-5)</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the index corresponding to the bra state</span>
<span class="sd">    m : int</span>
<span class="sd">        the index corresponding to the ket state </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    V_nm : float</span>
<span class="sd">         the matrix element corresponding to &lt;n|V|m&gt; = \psi_n(5) * psi_m(5)</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; V_12 = Potential_matrix_element(1,2)</span>
<span class="sd">    &gt;&gt;&gt; V_33 = Potential_matrix_element(3,3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">V_nm</span> <span class="o">=</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">V_nm</span>
</pre></div>
</div>
</div>
</div>
<section id="variational-optimization">
<h3>Variational optimization<a class="headerlink" href="#variational-optimization" title="Permalink to this headline">#</a></h3>
<p>Since we see that the linear Variational Method can be cast as an eigenvalue equation <span class="math notranslate nohighlight">\({\bf H} {\bf c} = E {\bf c}\)</span>,
we can find the Variational ground-state energy and wavefunction through the following steps:</p>
<ul class="simple">
<li><p>Build the matrix <span class="math notranslate nohighlight">\({\bf H}\)</span>; we will do this in the basis of energy eigenfunctions of the ordinary particle in a box</p></li>
<li><p>Diagonalize <span class="math notranslate nohighlight">\({\bf H}\)</span>; the lowest eigenvalue will be the variational approximation to the ground-state energy and the corresponding eigenvector will represent the expansion coeefficients for the variational ground-state wavefunction in terms of the basis functions.</p></li>
</ul>
<p>We can use <code class="docutils literal notranslate"><span class="pre">np.linalg.eigh()</span></code> to diagonalize the Hamiltonian matrix.</p>
<p>The following code block contains a helper function called <code class="docutils literal notranslate"><span class="pre">build_matrices(n_basis)</span></code> that will
build and return the Hamiltonian, Kinetic Energy, and Potential Energy matrices defined above.<br />
The argument <code class="docutils literal notranslate"><span class="pre">n_basis</span></code> will be used to determine the number of basis functions, and the
size of the resulsing matrices will be <code class="docutils literal notranslate"><span class="pre">n_basis</span> <span class="pre">x</span> <span class="pre">n_basis</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_matrices</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Function that will build and return the Hamiltonian, Kinetic, and Potential energy matrices</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n_basis : int</span>
<span class="sd">        the number of basis functions used to build the matrices</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : n_basis x n_basis array of floats</span>
<span class="sd">         the total Hamiltonian matrix</span>
<span class="sd">         </span>
<span class="sd">    T : n_basis x n_basis array of floats</span>
<span class="sd">         the kinetic energy matrix</span>
<span class="sd">         </span>
<span class="sd">    V : n_basis x n_basis array of floats</span>
<span class="sd">         the potential energy matrix </span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; H, T, V = build_matrices(3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_basis</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># i starts from 0 but n should start at 1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># j starts at 0 but m should start at 1</span>
            <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hamiltonian_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kinetic_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span>
</pre></div>
</div>
</div>
</div>
<p>The following line calls our <code class="docutils literal notranslate"><span class="pre">build_matrices</span></code> function to build <span class="math notranslate nohighlight">\({\bf H}\)</span>, <span class="math notranslate nohighlight">\({\bf T}\)</span>, and <span class="math notranslate nohighlight">\({\bf V}\)</span> matrices.
We will call the array that stores <span class="math notranslate nohighlight">\({\bf H}\)</span> <code class="docutils literal notranslate"><span class="pre">Hamiltonian_matrix</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_basis</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Hamiltonian_matrix</span><span class="p">,</span> <span class="n">Kinetic_matrix</span><span class="p">,</span> <span class="n">Potential_matrix</span> <span class="o">=</span> <span class="n">build_matrices</span><span class="p">(</span><span class="n">n_basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following lines will find the eigenvalues and eigenvectors of <span class="math notranslate nohighlight">\({\bf H}\)</span>.  The lowest energy
eigenvalue will be the variational estimate of the ground-state energy and the associated eigenvector
will be the variational estimate of the ground-state wavefunction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute eigenvalues and eigenvectors of Hamiltonian_matrix</span>
<span class="c1"># store eigenvalues to E_opt and eigenvectors to c_opt</span>
<span class="n">E_opt</span><span class="p">,</span> <span class="n">c_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">Hamiltonian_matrix</span><span class="p">)</span>

<span class="c1"># print lowest eigenvalues corresponding to the </span>
<span class="c1"># variational estimate of the ground state energy</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;The variational ground state energy with </span><span class="si">{</span><span class="n">n_basis</span><span class="si">}</span><span class="s1"> basis functions is </span><span class="si">{</span><span class="n">E_opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1"> atomic units&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The variational ground state energy with 3 basis functions is 0.165735 atomic units
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-variational-ground-state">
<h3>Visualizing the variational ground-state<a class="headerlink" href="#visualizing-the-variational-ground-state" title="Permalink to this headline">#</a></h3>
<p>Now that we have the variational eigenvectors (along with the eigenvalues), we can visualize the
variational ground-state wavefunction by expanding it in terms of the basis functions <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> using
the expansion coefficients from the ground-state eigenvector:
$<span class="math notranslate nohighlight">\( \Phi(x) = \sum_n c_n \psi_n(x). \)</span>$
The ground-state eigenvector can be accessed as a slice of <code class="docutils literal notranslate"><span class="pre">c_opt</span></code> as follows:
<code class="docutils literal notranslate"><span class="pre">c_opt[:,0]</span></code></p>
<p>We will build a numpy array of values from this expansion and plot it using <code class="docutils literal notranslate"><span class="pre">pyplot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize a numpy array for Phi_gs as an array of zeros with the same length as the x-axis used in the first cell</span>
<span class="n">Phi_gs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># loop through the basis states and add c_n \psi_n(x) to Phi_gs </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_basis</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">Phi_gs</span> <span class="o">+=</span> <span class="n">c_opt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
<span class="c1"># now plot the variational ground state along with the ground-state of the ordinary PIB</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Phi_gs</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Variational ground-state Probability Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">energy_eigenfunction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PIB ground state Probability Density&quot;</span><span class="p">)</span>
<span class="c1"># optionally plot the delta potential</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">10</span>  <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f39a42dbc70&gt;
</pre></div>
</div>
<img alt="../_images/linear_variational_method_13_1.png" src="../_images/linear_variational_method_13_1.png" />
</div>
</div>
</section>
</section>
<section id="questions-part-2">
<h2>Questions Part 2:<a class="headerlink" href="#questions-part-2" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>Is the energy you calculated above higher or lower than the ground state energy of the ordinary particle in a box system (that is, without the delta function potential)?</p></li>
<li><p>Why do you think mixing in functions that correspond to excited states in the ordinary particle in a box system actually helped to improve (i.e. lower) your energy in the system with the delta function potential?</p></li>
<li><p>Increase the number of basis functions to 50 (so that <span class="math notranslate nohighlight">\({\bf H}\)</span> is a 50x50 matrix and <span class="math notranslate nohighlight">\({\bf c}\)</span> is a vector with 50 entries) and repeat your calculation of the variational estimate of the ground state energy.  Does the energy improve (lower) compared to what it was when 3 basis functions were used?  Do you notice any difference in the plot of the variational estimate of the ground-state probability density?</p></li>
</ol>
</section>
<section id="behavior-of-total-energy-kinetic-energy-and-potential-energy-functionals-with-basis-set-size">
<h2>Behavior of Total Energy, Kinetic Energy, and Potential Energy functionals with basis set size.<a class="headerlink" href="#behavior-of-total-energy-kinetic-energy-and-potential-energy-functionals-with-basis-set-size" title="Permalink to this headline">#</a></h2>
<p>Typically speaking, the quality of the variational ground-state energy improves with the basis set size.
Here we will look at the behavior of the total energy, the kinetic energy, and the potential energy of the
trial wavefunction as a function of basis set size.</p>
<p>For a given trial wavefunction (as determined by the variationally determined ground-state eigenvector <span class="math notranslate nohighlight">\({\bf c}\)</span>,
we can define the total energy as</p>
<div class="amsmath math notranslate nohighlight" id="equation-25c42a11-ed84-47f9-8733-f4556476fb38">
<span class="eqno">(12)<a class="headerlink" href="#equation-25c42a11-ed84-47f9-8733-f4556476fb38" title="Permalink to this equation">#</a></span>\[\begin{equation}
E = {\bf c}^t {\bf H} {\bf c} 
\end{equation}\]</div>
<p>the kinetic energy as</p>
<div class="amsmath math notranslate nohighlight" id="equation-d3366986-a8ca-4a27-b4d6-ab339aa3a99b">
<span class="eqno">(13)<a class="headerlink" href="#equation-d3366986-a8ca-4a27-b4d6-ab339aa3a99b" title="Permalink to this equation">#</a></span>\[\begin{equation}
T = {\bf c}^t {\bf T} {\bf c},
\end{equation}\]</div>
<p>and the potential energy as</p>
<div class="amsmath math notranslate nohighlight" id="equation-ff0b4f43-67fd-418b-b839-d47321eff5ab">
<span class="eqno">(14)<a class="headerlink" href="#equation-ff0b4f43-67fd-418b-b839-d47321eff5ab" title="Permalink to this equation">#</a></span>\[\begin{equation}
V = {\bf c}^t {\bf V} {\bf c}.
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\({\bf c}^t\)</span> is just the transpose of <span class="math notranslate nohighlight">\({\bf c}\)</span>. We will perform this computation for
basis set sizes spanning <code class="docutils literal notranslate"><span class="pre">n_basis</span> <span class="pre">=</span> <span class="pre">2</span></code> to <code class="docutils literal notranslate"><span class="pre">n_basis</span> <span class="pre">=</span> <span class="pre">202</span></code>, and we will compare to the
ground state and first excited state of the ordinary particle in a box (<span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the number of basis functions</span>
<span class="n">n_basis_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">E_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">T_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">V_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">E_1_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">E_2_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">n_basis_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">build_matrices</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">e_t</span><span class="p">,</span> <span class="n">c_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">E_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">T_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">c_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">T_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">c_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">T_c</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">V_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">c_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">V_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">c_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">V_c</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">E_1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">E_2_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    
    

    
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_basis_list</span><span class="p">,</span> <span class="n">E_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_basis_list</span><span class="p">,</span> <span class="n">T_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_basis_list</span><span class="p">,</span> <span class="n">V_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_basis_list</span><span class="p">,</span> <span class="n">E_1_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E_1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_basis_list</span><span class="p">,</span> <span class="n">E_2_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E_2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f39a1fe4f40&gt;
</pre></div>
</div>
<img alt="../_images/linear_variational_method_18_1.png" src="../_images/linear_variational_method_18_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ESCIP/escip.github.io",
            ref: "jbook",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="fourier_transform.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Fourier Transforms</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="gaussian_wavepacket.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time evolution of a Gaussian wavepacket</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ESCIP Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>